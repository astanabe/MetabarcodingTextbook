<!DOCTYPE html><html prefix="dcterms: http://purl.org/dc/terms/">
<head>
<title>生態学のためのメタバーコーディングとDNAバーコーディング</title>
<!--Generated on Fri Sep 16 14:13:22 2016 by LaTeXML (version 0.8.0_02) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on September 16, 2016.-->

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="LaTeXML.css" type="text/css">
<link rel="stylesheet" href="ltx-book.css" type="text/css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">生態学のためのメタバーコーディングとDNAバーコーディング</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">田辺晶史
</span></span>
</div>
<div class="ltx_date ltx_role_creation">2016年9月16日</div>

<section id="Chx1" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">はじめに</h2>

<div id="Chx1.p1" class="ltx_para">
<p class="ltx_p">本書は、筆者が開発した塩基配列アセンブラー「Assams」と、配列のクラスタリングとホスト生物同定のためのパッケージ「Claident」の利用を普及促進するために執筆を開始しました。
これらのプログラムの利用方法のみならず、データの取得方法からDNAバーコーディングによる生物の同定方法まで解説しています。</p>
</div>
<div id="Chx1.p2" class="ltx_para">
<p class="ltx_p">細菌などの研究においては既に広く利用されているメタバーコーディングですが、細菌以外の分類群でも幅広い応用が考えられます。
例えば、土壌や動植物体内の真菌、水中の動植物プランクトンなどにも適用可能だと思います。
水中の溶け出している大型動植物の環境DNAでも同様の解析が可能でしょう。
本書では、環境DNAやメタゲノムから、DNAバーコーディングに利用される領域を増幅し、比較的長い解読長の第2世代以降のシーケンサーで配列を読み取って、DNAバーコーディングによって配列のホスト生物を特定することで生物の在・不在を調査する方法を解説します。
また、メタバーコーディングに限らず、様々な分野で応用が進みつつあるDNAバーコーディングを用いて生物を同定する方法についても解説しています。</p>
</div>
<div id="Chx1.p3" class="ltx_para">
<p class="ltx_p">本書はクリエイティブ・コモンズの表示-継承 2.1 日本ライセンスの下で配布します。
このライセンスの下では、原著作者の明示を行う限り、利用者は自由に本書を複製・頒布・展示することができます。
また、原著作者の明示と本ライセンスまたは互換性のあるライセンスの適用を行う限り、本書を改変した二次著作物の作成・配布も自由に行うことができます。
詳しい使用許諾条件を見るには
<br class="ltx_break"><a href="http://creativecommons.org/licenses/by-sa/2.1/jp/" title="" class="ltx_ref">http://creativecommons.org/licenses/by-sa/2.1/jp/</a>
<br class="ltx_break">をチェックするか、クリエイティブ･コモンズに郵便にてお問い合わせください。
住所は：171 Second Street, Suite 300, San Francisco, California 94105, USA です。</p>
</div>
<div id="Chx1.p4" class="ltx_para">
<p class="ltx_p">本書が皆さんの役に立つことができましたら幸いです。
この機会を与えて下さった京都大学大学院人間・環境学研究科の東樹宏和博士、水産研究・教育機構中央水産研究所の長井敏博士と、本書をお読みの皆さんに感謝します。</p>
</div>
</section>
<section id="Chx2" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">凡例</h2>

<div id="Chx2.p1" class="ltx_para">
<p class="ltx_p">本書ではコンピュータに入力するコマンドやその結果を表記する際に以下のように記述しています。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># コメント</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; command argument1 \</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">argument2 \</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">argument3↓</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">output of command</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; command argument1 argument2 argument3↓</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">output of command</span>
        </span>
</p>
<p class="ltx_p">上記の例では<span class="ltx_text ltx_font_typewriter">command argument1 argument2 argument3</span>という全く同じコマンドを2回実行しており、コマンド実行後に<span class="ltx_text ltx_font_typewriter">output of command</span>がコマンドにより表示されています。
ここで、#から改行まではコメントを表しており、入力の必要はありません。
行頭の<span class="ltx_text ltx_font_typewriter">&gt;</span>とそれに続くスペースはコマンドの入力の開始を表しており、↓までがコマンドとオプションの入力内容になります。
<span class="ltx_text ltx_font_typewriter">&gt;</span>とそれに続くスペースはあくまで入力の開始を示すためのものですので、入力しないで下さい。
↓は入力の終端を表し、ここでEnterキーを押すことを指示する記号です。
↓を入力しないようにして下さい。
なお、コマンドとオプションを見やすくするためにコマンドやオプションの途中に改行を意図的に入れることがありますが、そのような改行の直前には<span class="ltx_text ltx_font_typewriter">\</span>を記してあります。
したがって、<span class="ltx_text ltx_font_typewriter">\</span>が直前にある改行はコマンドの終端や改行入力の指示を意味しません。
また、表示環境によってはワードラップ機能により筆者の意図しない改行が入ってしまうことがありますが、これもコマンドの終端や改行入力の指示を意味しませんので注意して下さい。</p>
</div>
<div id="Chx2.p2" class="ltx_para">
<p class="ltx_p">また、本書では様々なファイルを使用しますが、その内容は以下のように記述しています。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 1行目の内容</span>
        </span>
<span class="ltx_p ltx_align_left">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 2行目の内容</span>
        </span>
</p>
<p class="ltx_p">この例では、行頭の<span class="ltx_text ltx_font_typewriter">|</span>とそれに続くスペースはファイル内の行頭を表しており、ファイル作成の際は入力しないように注意して下さい。
これは、ワードラップ機能による筆者の意図しない改行とファイルに入力すべき改行を区別できるようにするためのものです。</p>
</div>
</section>
<section id="Ch0" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第0章 </span>ソフトウェアのインストールと環境設定</h2>

<div id="Ch0.p1" class="ltx_para">
<p class="ltx_p">本書では、Debian GNU/Linux jessie (以下Debian)、Ubuntu Linux 14.04 LTS (以下Ubuntu)を利用環境として想定しています。
Windows環境の方は、Linuxのどちらかをインストールして環境を整えて下さい。
動作が遅くても構わないなら、CygwinやWindows 10 build 14393以降で提供されているWindows Subsystem for LinuxなどのWindows上で動作するUNIX互換環境にインストールすることも可能です。
Linuxのインストールには、インストール用CD・DVD・USBメモリが使えます。
HDDやSSDが1台しかない場合、Windows用のEaseUS Partition Masterなどのパーティションリサイズが可能なソフトを使ったり、インストール用CD・DVD・USBメモリ内に用意されている機能を使ってWindows用の領域を縮小して容量を空ける必要があります。
HDDまたはSSDを追加してスペースを確保していただいても良いでしょう。
USBメモリやUSB接続HDDにインストールすることも可能です。
Ubuntuは見た目・操作性の異なる何種類かがありますが、標準のUbuntuよりもXubuntuというのがおすすめです。</p>
</div>
<div id="Ch0.p2" class="ltx_para">
<p class="ltx_p">Macでも、これらのOSがインストールできます。
空きディスクがない場合はディスクユーティリティを用いてLinuxインストール用のスペースを空ける必要があります。
ディスクユーティリティでHDD・SSDをクリックして、MacOS Xが使用している領域を縮小して下さい。
そしてrEFItやrEFIndというソフトをインストールして起動時に起動デバイス・起動OS選択メニューが出るようにします(インストール後に2回の再起動が必要です)。
そうすると、Linuxインストール用CD・DVD・USBメモリから起動できるようになりますので、そこから起動してインストールして下さい。
くれぐれも既存のOS用領域を誤って削除しないようにご注意下さい。
空いているディスク領域がある場合はディスクユーティリティでの操作は必要ありません。
rEFItやrEFIndを導入してインストールCD・DVD・USBメモリから起動し、空いている領域にLinuxをインストールしていただければ結構です。
またMacでも、インストール先をUSBメモリやUSB接続HDDにすることができます。</p>
</div>
<div id="Ch0.p3" class="ltx_para">
<p class="ltx_p">なお、本書は64bit対応のIntel・AMD製CPU搭載機しか想定していません。
それ以外の環境でも動作するでしょうが、自力で解決していただく必要があります。
導入するLinuxは64bit版にして下さい。
32bit版では大容量メモリを活かすことができません。</p>
</div>
<section id="Ch0.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">0.1 </span>LinuxへのClaidentおよび同定用データベースと必要なプログラムのインストール</h3>

<div id="Ch0.S1.p1" class="ltx_para">
<p class="ltx_p">以下のコマンドをターミナルかコンソールで実行して下さい。
必要なものが全てインストールされます。
<span class="ltx_text ltx_font_typewriter">sudo</span>を利用可能なユーザーである必要があります。
途中、<span class="ltx_text ltx_font_typewriter">sudo</span>の実行時に何回かパスワードを質問されますので、入力して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; mkdir -p ~/workingdirectory↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cd ~/workingdirectory↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; wget https://www.claident.org/installClaident_Debian.sh↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh installClaident_Debian.sh↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; wget https://www.claident.org/installOptions_Debian.sh↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh installOptions_Debian.sh↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; wget https://www.claident.org/installDB_Debian.sh↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh installDB_Debian.sh↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; wget https://www.claident.org/installUCHIMEDB_Debian.sh↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh installUCHIMEDB_Debian.sh↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cd ..↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; rm -r workingdirectory↓</span>
          </span>
</p>
<p class="ltx_p">標準のインストール先は<span class="ltx_text ltx_font_typewriter">/usr/local</span>以下になります。
また、<span class="ltx_text ltx_font_typewriter">Permission denied</span>と言われた直後にパスワードを尋ねられたりしますが、パスワードに答えることで進行する場合は問題ありません。
これは、最初は<span class="ltx_text ltx_font_typewriter">sudo</span>なしにユーザー権限でインストールを試み、うまく行かなかった場合(ここでエラーになる)に初めて<span class="ltx_text ltx_font_typewriter">sudo</span>を使って管理者権限でインストールしようとする(ここでパスワードを尋ねられる)ためです。</p>
</div>
<div id="Ch0.S1.p2" class="ltx_para">
<p class="ltx_p">もしも外部ネットワークへのアクセスにプロキシを設定する必要がある場合は、上記のコマンド実行の前に以下のコマンドを実行して環境変数を設定しておいて下さい。
これにより、外部へはプロキシを経由してアクセスが行われるようになります。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export http_proxy=http://server.address:portnumber↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export https_proxy=$http_proxy↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export ftp_proxy=$http_proxy↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export all_proxy=$http_proxy↓</span>
          </span>
</p>
<p class="ltx_p">なお、ユーザー名とパスワードを用いた認証が必要なプロキシでは、以下のようにして下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export http_proxy=http://username:password@server.address:portnumber↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export https_proxy=$http_proxy↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export ftp_proxy=$http_proxy↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export all_proxy=$http_proxy↓</span>
          </span>
</p>
</div>
<section id="Ch0.S1.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.1.1 </span>バージョンアップの場合には</h4>

<div id="Ch0.S1.SS1.p1" class="ltx_para">
<p class="ltx_p">全てのプログラムとデータベースを更新する場合は、インストールと同様の手順でコマンドを実行して下さい。
この手順では、Assams、Claident、PEAR、VSEARCH、Metaxa、ITSxが<span class="ltx_text ltx_font_typewriter">/usr/local</span>以下へインストールされ、<span class="ltx_text ltx_font_typewriter">/usr/local/share/claident</span>以下へNCBI BLAST+と同定用BLASTデータベース・Taxonomyデータベース、その他の依存プログラム等がインストールされます。
NCBI BLAST+やBLASTデータベースが別途システムにインストールされている場合でも、Claidentが利用するBLAST+やデータベースとは共存可能です。</p>
</div>
<div id="Ch0.S1.SS1.p2" class="ltx_para">
<p class="ltx_p">なお、以下のコマンドを利用することで、一部の更新を無効化して他のものだけ更新することができます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; mkdir -p ~/workingdirectory↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cd ~/workingdirectory↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># Assamsの更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .assams↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># Claidentの更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .claident↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># PEARの更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .pear↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># VSEARCHの更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .vsearch↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># NCBI BLAST+の更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .blast↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># プログラムを更新
&gt; wget https://www.claident.org/installClaident_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh installClaident_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># sff_extractの更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .sffextract↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># HMMerの更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .hmmer↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># MAFFTの更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .mafft↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># Metaxaの更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .metaxa↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># ITSxの更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .itsx↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># オプションプログラムを更新
&gt; wget https://www.claident.org/installOptions_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh installOptions_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 同定用データベース「overall」の更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .overall↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 同定用データベースを更新
&gt; wget https://www.claident.org/installDB_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh installDB_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># キメラ検出用データベース「rdp」の更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .rdp↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># キメラ検出用データベース「unite」の更新を無効化</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; touch .unite↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># キメラ検出用データベースを更新
&gt; wget https://www.claident.org/installUCHIMEDB_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh installUCHIMEDB_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cd ..↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; rm -r workingdirectory↓</span>
            </span>
</p>
</div>
</section>
<section id="Ch0.S1.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.1.2 </span>標準以外の場所にインストールする</h4>

<div id="Ch0.S1.SS2.p1" class="ltx_para">
<p class="ltx_p">前述の方法でインストールすると、標準では<span class="ltx_text ltx_font_typewriter">/usr/local</span>以下へインストールされます。
コマンドは<span class="ltx_text ltx_font_typewriter">/usr/local/bin</span>にインストールされます。
他のプログラム(特に旧バージョン)との共存を図りたい場合は、インストール場所を変更して、使用する場合に環境変数PATHを変更するのがいいでしょう。
以下のコマンドで標準とは異なる場所へインストールすることができます。</p>
</div>
<div id="Ch0.S1.SS2.p2" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; mkdir -p ~/workingdirectory↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cd ~/workingdirectory↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export PREFIX=インストール先にしたい場所↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; wget https://www.claident.org/installClaident_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh installClaident_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; wget https://www.claident.org/installOptions_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh installOptions_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; wget https://www.claident.org/installDB_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh installDB_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; wget https://www.claident.org/installUCHIMEDB_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sh installUCHIMEDB_Debian.sh↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cd ..↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; rm -r workingdirectory↓</span>
            </span>
</p>
</div>
<div id="Ch0.S1.SS2.p3" class="ltx_para">
<p class="ltx_p">なお、使用する際には、以下のコマンドを実行する必要があります。</p>
</div>
<div id="Ch0.S1.SS2.p4" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; export PATH=インストールした場所/bin:$PATH↓</span>
          </p>
</div>
<div id="Ch0.S1.SS2.p5" class="ltx_para">
<p class="ltx_p">毎回上記コマンドを実行するのが面倒な場合は、<span class="ltx_text ltx_font_typewriter">~/.bash_profile</span>や<span class="ltx_text ltx_font_typewriter">~/.bashrc</span>の末尾に上記コマンドを記述しておけばいいでしょう。</p>
</div>
</section>
<section id="Ch0.S1.SS3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">0.1.3 </span>複数のバージョンを共存させる</h4>

<div id="Ch0.S1.SS3.p1" class="ltx_para">
<p class="ltx_p">Claidentは標準のインストール先にインストールすると以前のバージョンがあっても上書きされますが、前述の通り標準以外の場所にインストールすれば複数のバージョンを共存させることができます。
ただし、ユーザーのホームディレクトリ(<span class="ltx_text ltx_font_typewriter">/home/ユーザー名</span>)の直下もしくは<span class="ltx_text ltx_font_typewriter">/etc/claident</span>に作成される設定ファイル<span class="ltx_text ltx_font_typewriter">.claident</span>は共存できませんので、本設定ファイルは使用するバージョンに合わせて切り替える必要があります。
ユーザーのホームディレクトリの設定ファイルが優先的に読み込まれますので、複数バージョンを共存させる場合はそれぞれ別のユーザーを用意してそのユーザーのホームディレクトリ以下にインストールしていただければ、ユーザーを切り替えることでバージョンを切り替えることができます。</p>
</div>
</section>
</section>
</section>
<section id="Ch1" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第1章 </span>次世代シーケンサーによる大量サンプルの塩基配列決定</h2>

<div id="Ch1.p1" class="ltx_para">
<p class="ltx_p">ここでは、Roche GSシリーズシーケンサーや、Ion PGM、Illumina MiSeqによるタグ付き塩基配列決定法について簡単に説明します。
これらのシーケンサーは、いずれも400bp以上の長さの塩基配列解読能力があり、メタバーコーディング、DNAバーコーディングに適しています。
ただし、MiSeqは両側から解読したもの(ペアエンドリード)を連結する必要があります。
したがって、両側の配列間でオーバーラップができるよう、できれば400bp程度、長くても500bp程度のアンプリコンができるようにPCRしなくてはなりません。
連結せずに片側ずつ解析することもできますが、reverse側配列は質がかなり低いため、あまり有用ではないと思います。</p>
</div>
<div id="Ch1.p2" class="ltx_para">
<p class="ltx_p">次世代シーケンサーは非常に多くの塩基配列を解読できますが、かつてはランニングコストが高く、1度に多数のサンプル由来配列を由来サンプルがわかるように解読することができませんでした。
しかし、ランニングコストはかなり下がってきた上、塩基配列に由来サンプル識別用の数塩基の「MID (multiplex identifier)タグ」を予め付加して解読することで、多数のサンプルの塩基配列を混合(multiplex)して1度に解読できるようになりました。
これにより、1サンプル当たりのコストも劇的に低下しています。
MIDタグをバーコードと呼ぶことも多いですが、DNAバーコーディングでは利用する塩基配列をバーコードと呼び、紛らわしいのでここでは単にタグに統一します。
なお、インデックス配列と呼ぶ場合もあります。
他の文書を読まれる場合は注意して下さい。</p>
</div>
<div id="Ch1.p3" class="ltx_para">
<p class="ltx_p">なお、後の解析では、PCRの際に生成されるキメラ配列や読み間違いの多い配列が多様性の把握の際に問題となりますが、PCRのレプリケートを確保して塩基配列決定を行うことで、全レプリケートで共通して見られる配列のみをキメラでなく読み間違いも少ない配列と考えることができます。
これは、キメラのできる配列の組み合わせとキメラ配列の「継ぎ目」は多数あるが、キメラでない配列は非常に限られていてしかもPCR前からあって観測される数がキメラより多くなりやすいため、真の配列は全てのレプリケートで検出されやすいが、キメラはそうではないこと、同様に読み間違いのパターンも無数にあるが真の配列はただ一通りで真の配列が全レプリケートで検出されやすいことを利用するものです。
ソフトウェアによる処理だけではキメラや読み間違いを十分に除去できませんが、この方法を併用することで検出効率を改善できると期待できます。
キメラと読み間違いの検出後、レプリケートは足し合わせて解析することができます。</p>
</div>
<section id="Ch1.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1.1 </span>タグ・アダプター配列付きプライマーを用いたPCR</h3>

<div id="Ch1.S1.p1" class="ltx_para">
<p class="ltx_p">タグを配列に付加するには、タグの付いたプライマーを用いてPCRを行うのが最も簡単で確実です。
PCR方式では初期投資としてタグ付きプライマーを購入する必要があり、タグの種類を多くしようとするとこれに最大数十万円を要します。
次世代シーケンサー用のサンプル調製キットでは、予めサンプル内のDNA末端に特定のアダプター配列のDNAが付加されていることを前提としています。
そこで、以下のような配列のプライマーを用いてPCRを行います。
なお、鋳型DNAはメタゲノムでも単一のゲノムでもどちらでも構いません。</p>
<p class="ltx_p ltx_align_left" style="border-left:0.5em solid #000000;padding:0.5em 1em 0.5em 1em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">5' ― [アダプター配列] ― [タグ配列] ― [本来のプライマー配列] ― 3'</span>
        </p>
<p class="ltx_p">両側にタグを付けた場合は、増幅産物は以下のような形になります。</p>
<p class="ltx_p ltx_align_left" style="border-left:0.5em solid #000000;padding:0.5em 1em 0.5em 1em;">
          <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">5' ― [アダプター配列F] ― [タグ配列F] ― [本来のプライマー配列F] ― [解読したい配列] ― [本来のプライマー配列R逆相補] ― [タグ配列R逆相補] ― [アダプター配列R逆相補] ― 3'</span>
        </p>
<p class="ltx_p">片側から解読する場合、読み始めがタグ配列Fで、本来のプライマー配列F、解読したい配列の順で読むことになります。</p>
</div>
<div id="Ch1.S1.p2" class="ltx_para">
<p class="ltx_p">どのようなタグを使うかは、<cite class="ltx_cite"><a href="#bib.bib7" title="" class="ltx_ref">Hamady <span class="ltx_text ltx_font_italic">et al</span>. (2008)</a></cite>のSupplementなど、既存の文献を見て決めて下さい。
ただし、タグが必要なのは解読開始側だけですので、片側からしか読まない場合には反対側はタグのないプライマーを使います。
両側から読む場合でも、サンプル数が少ない場合は片側だけでいいのですが、解読ミスのためフォワード配列とリバース配列の対応がおかしくなることがあり、片側しかタグがないとそれが検出できませんので両側に付けることを推奨します。</p>
</div>
<div id="Ch1.S1.p3" class="ltx_para">
<p class="ltx_p">このようなプライマーを用いてPCRを行うと、プライマーは鋳型DNAにY字型にアニールし、アダプター配列とタグ配列が端に付加された増幅産物ができます。
この増幅産物をできるだけ等濃度で混合してシーケンスサンプルを調製し、シーケンサーで塩基配列を解読します。
シーケンスサンプル調整ステップ以降はメーカーから提供されている純正キットとそのプロトコルに従って下さい。
メーカー提供のプロトコルにはいくつか改善すべき点があり、改善によってデータの品質が向上することもあるようです。
詳しくはその筋の方にお問い合わせ下さい。
濃度の測定は、Nanodropなどの分光光度計では十分な精度で行うことができません。
そのため、最低でもThermoFisher (旧Invitrogen)のQubitなどで測定して下さい。
シーケンスサンプルのアダプター配列をターゲットとして定量PCRによって測定するタイプのキットが最も高精度ですが、これはランニングコストが非常に高いためサンプルが多い場合は適用できないと思います。</p>
</div>
<div id="Ch1.S1.p4" class="ltx_para">
<p class="ltx_p">なお、プライマー配列もサンプルを区別する用途に使うことができますので、例えば植物の<span class="ltx_text ltx_font_italic">rbcL</span>と<span class="ltx_text ltx_font_italic">matK</span>などの複数領域配列を同時に各サンプルから得ることもできます。
もちろんこれらは塩基配列データを見ることでも区別できます。
PCRでは、伸長時間を長めに取り、サイクル数を少なくするようにして下さい。
シーケンスサンプル調製に必要なDNA量は多くありませんので、サイクル数をそれほど多くする必要はないのです。
サイクル数が多く伸長時間が短いほど、「途中まで合成された産物」が生成され、それが次のサイクルで別の鋳型に基いて伸長する、ということが多くなります。
このようにして生成されたDNAはキメラDNAと呼ばれ、「存在しない新奇生物の発見」や「多様性の過大評価」に繋がります。
Finnzymes社のPhusionや東洋紡のKODなどの高正確性DNAポリメラーゼを用いるのも対策として有効です。
キメラDNAの生成を抑制するためには、熱変性後にアニーリング温度へと下げるときの速度を下げることがよいという報告があります<cite class="ltx_cite"><a href="#bib.bib17" title="" class="ltx_ref">(Stevens <span class="ltx_text ltx_font_italic">et al</span>., 2013)</a></cite>ので、もし温度の変化速度を設定可能なサーマルサイクラーであれば温度変化速度を下げるようにして下さい。
後述するプログラムによる処理によって除去することもできますが、完全ではありませんので生成を抑えるのに越したことはありません。</p>
</div>
<div id="Ch1.S1.p5" class="ltx_para">
<p class="ltx_p">増幅の難しい鋳型の場合、夾雑物があっても増えやすくする島津製作所のAmpdirectなどの試薬を用いてPCRを行ったり、そもそもDNAを抽出する段階でホモジナイザーやビーズ破砕機を用いて細胞を破砕した上でDNAを抽出することで収量を増やすなどの対策が必要になります。
破砕の前にディープフリーザーで凍結して、凍結した状態で破砕するのも効果的です。
ポリフェノール類や多糖類を除去するキットを用いる必要がある場合もあるかもしれません。
この辺りの課題は従来の方法と違いはありません。
タグ・アダプターの付いていないプライマーでは増幅できるがタグ・アダプター付きのプライマーだとうまくいかないことがありますが、その場合はタグ・アダプターなしのプライマーでPCRした増幅産物を用意し、プライマー除去・精製して(ExoSAP-ITなどでいいでしょう)から、タグ・アダプターの付いたプライマーで数サイクルのPCRを行い、増幅産物にタグ・アダプターを付加するというやり方でうまくいくことがあります。</p>
</div>
<section id="Ch1.S1.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1.1 </span>中間アダプターを用いたコスト抑制方法</h4>

<div id="Ch1.S1.SS1.p1" class="ltx_para">
<p class="ltx_p">タグ・アダプター配列付きプライマーは非常に長いため、高価になりがちです。
しかも、増幅するプライマーセットごとに用意しなくてはならず本数も多くなってしまいます。
そこで、PCRを2回行うことで、1組のタグ・アダプター付きプライマーを使い回す方法を紹介します。
まず、1回目は以下のプライマーセットを用いてPCRを行います。</p>
<p class="ltx_p ltx_align_left" style="border-left:0.5em solid #000000;padding:0.5em 1em 0.5em 1em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">5' ― [中間アダプター配列] ― [本来のプライマー配列] ― 3'</span>
          </p>
<p class="ltx_p">これで末端に中間アダプター配列の付いた増幅産物ができます。
中間アダプター配列はシーケンスに必要なアダプター配列と異なるもので、非特異的増幅を起こさないものであれば何でも構いません。
そういう配列は各種知られていますので、既に使用されているものを探してきて下さい。
そして、この増幅産物を鋳型として以下のプライマーセットでさらにPCRを行います。</p>
<p class="ltx_p ltx_align_left" style="border-left:0.5em solid #000000;padding:0.5em 1em 0.5em 1em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">5' ― [本来のアダプター配列] ― [タグ配列] ― [中間アダプター配列] ― 3'</span>
          </p>
<p class="ltx_p">このような2段階PCRによって、1組のタグ・アダプター付きプライマーを使い回すことができるようになりますので、コスト削減になります。
ただし、PCRを繰り返すため、PCRによる人工的な置換やPCRバイアスが増加しますし、解読できる長さも減少します。
その点には注意が必要です。
なお、増幅産物は以下のような形になります。</p>
<p class="ltx_p ltx_align_left" style="border-left:0.5em solid #000000;padding:0.5em 1em 0.5em 1em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">5' ― [本来のアダプター配列F] ― [タグ配列F] ― [中間アダプター配列F] ― [本来のプライマー配列F] ― [解読したい配列] ― [本来のプライマー配列R逆相補] ― [中間アダプター配列R逆相補] ― [タグ配列R逆相補] ― [本来のアダプター配列R逆相補] ― 3'</span>
          </p>
<p class="ltx_p">IlluminaのNextera XT Index Kitを用いたmultiplex法<cite class="ltx_cite"><a href="#bib.bib9" title="" class="ltx_ref">(Illumina corporation, 2013)</a></cite>はこれをキットで実現しているものです。
この方法で2つのタグ配列と両側からの解読を行う場合、最初に中間アダプター配列Fの後ろから、つまり本来のプライマー配列Fから読み始め、解読したい配列方向へ解読します。
次に、中間アダプター配列R逆相補の後ろからタグ配列R逆相補を解読します。
3番目にアダプター配列Fの後ろからタグ配列Fを解読し、方向を反転させて、最後に中間アダプター配列Rの後ろから本来のプライマー配列R、および解読したい配列(逆ストランド)を解読します。
それぞれがR1、R2、R3、R4を含むファイル名で保存されます。
R1、R2、R3は同じstrandで、R4だけ逆strandになります。
R2はタグ配列R逆相補で、R3がタグ配列Fです。
ややこしいので注意が必要です。
なお、上記のキットではR1とR4のシーケンスプライマーは中間アダプター配列をターゲットとするものになっているため、本来のプライマー配列がR1とR4のデータ配列に入ってしまい、解読したい領域が500bp程度ある場合には長さが不足する可能性がありますが、本来のプライマーをシーケンスプライマーとして利用することでデータ配列にプライマー部分が入らないようすることも可能です。
ただし、この方法では後述するNの挿入によるシーケンス品質の改善ができません。</p>
</div>
</section>
<section id="Ch1.S1.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">1.1.2 </span>Nの挿入によるシーケンス品質の改善</h4>

<div id="Ch1.S1.SS2.p1" class="ltx_para">
<p class="ltx_p">Illuminaでは、フローセル上の蛍光を光学センサーで読み取っていますが、メタゲノムを鋳型としたユニバーサルプライマーでのPCR増幅産物は配列が似ているため、フローセル上でDNAが近接していると区別が困難になります。
また、読み始め(特に最初の12塩基)に「ほとんどの配列がAであるため発光点が少なく真っ暗になる」と、異常と判断して解読を停止してしまうことがあるとのことです。
ゲノムショットガンやRNA-seqでは近接しているDNAが非常によく似ている可能性がずっと低いために区別できる上、真っ暗になることもないのですが、同じ遺伝子座の増幅産物(しかも読み始めがほとんど変異のないプライマー領域)だとまずいわけです。
そこで、本来のプライマー配列と中間アダプター配列の間にわざと<span class="ltx_text ltx_font_typewriter">NNNNNN</span>を入れてしまうことにします。
そうすると、この部分の解読時に近接したDNAも区別することができ、真っ暗になることもないため、シーケンス品質が改善するとのことです<cite class="ltx_cite"><a href="#bib.bib15" title="" class="ltx_ref">(Nelson <span class="ltx_text ltx_font_italic">et al</span>., 2014)</a></cite>。
MiSeqやHiSeqをお使いの方はお試し下さい。
さらに、この長さをサンプルごとに変えてしまうと、解読するゲノム上の位置がずれるため、全く同じ配列が隣接していても区別できるようになるためにシーケンス品質が改善するそうです<cite class="ltx_cite"><a href="#bib.bib6" title="" class="ltx_ref">(Fadrosh <span class="ltx_text ltx_font_italic">et al</span>., 2014)</a></cite>。
これらの対処法により、PhiX標準配列を混ぜる量を減らすことができるので、一度に得られるデータ量も増加するはずです。</p>
</div>
</section>
</section>
</section>
<section id="Ch2" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第2章 </span>塩基配列データの前処理</h2>

<div id="Ch2.p1" class="ltx_para">
<p class="ltx_p">GSシリーズシーケンサーやIon PGMでは、最終出力として<span class="ltx_text ltx_font_typewriter">*.sff</span>というファイルが得られます。
Illumina MiSeqの場合は<span class="ltx_text ltx_font_typewriter">*.fastq</span>となります。
ここでは、これらのファイルに含まれる配列をサンプルごとに分別(demultiplex)して別々のファイルに分けた上で、低品質の配列の除去を行う方法を説明します。
どの機種でもメーカーのプログラムの機能によるdemultiplexは品質の値を見ていなかったりするため、Claidentのコマンド<span class="ltx_text ltx_font_typewriter">clsplitseq</span>を利用してdemultiplexを行います。
以下ではコマンドは全てターミナルかコンソールで実行して下さい。
基本的なターミナルの使い方の知識は持っているという前提で話を進めます。
ターミナルの操作に慣れていない方は、最低でも付録<a href="#A2" title="付録 B ターミナルコマンド集 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>の内容を理解できるようになっておいて下さい。</p>
</div>
<section id="Ch2.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.1 </span>SRA/DRA/ERAの登録データやdemultiplex済FASTQの変換</h3>

<div id="Ch2.S1.p1" class="ltx_para">
<p class="ltx_p">Claidentでは、配列の名前として<span class="ltx_text ltx_font_typewriter">配列ID__ランID__タグID__プライマーID</span>を、また拡張子を除いた入力ファイル名として<span class="ltx_text ltx_font_typewriter">ランID__タグID__プライマーID</span>を仮定しています。
そのため、SRA/DRA/ERAの登録データやdemultiplex済FASTQをそのまま用いることができません。
そこで、<span class="ltx_text ltx_font_typewriter">climportfastq</span>というコマンドを用いることで、上記の仮定を満たす入力ファイルに変換することができます。
ペアエンドの場合は変換する前に第<a href="#Ch2.S3.SS3" title="2.3.3 フォワード配列とリバース配列の連結 ‣ 2.3 Illumina社シーケンサーの場合 ‣ 第2章 塩基配列データの前処理 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.3.3</span></a>節の内容に従ってフィルタリングと連結を先に行っておきます。
変換するには、以下のような入力ファイルを用意します。</p>
</div>
<div id="Ch2.S1.p2" class="ltx_para">
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 配列ファイル名1 ランID__タグID__プライマーID</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 配列ファイル名2 ランID__タグID__プライマーID</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 配列ファイル名3 ランID__タグID__プライマーID</span>
          </span>
</p>
</div>
<div id="Ch2.S1.p3" class="ltx_para">
<p class="ltx_p">ランIDは適当にでっち上げていただいて構いません。
プライマーIDは同じプライマーを用いたファイル間で同じになるようにすれば何でも構いません。
タグIDはファイルごとに異なるものにします。
配列ファイル名と同じでも構いません。</p>
</div>
<div id="Ch2.S1.p4" class="ltx_para">
<p class="ltx_p">上記の入力ファイルが用意できたら、以下のように<span class="ltx_text ltx_font_typewriter">climportfastq</span>を実行することで、出力フォルダに変換後のファイルが作成されます。</p>
</div>
<div id="Ch2.S1.p5" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; climportfastq \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=CPU数 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
          </span>
</p>
</div>
<div id="Ch2.S1.p6" class="ltx_para">
<p class="ltx_p">変換後、シングルエンドデータであれば第<a href="#Ch2.S2.SS3" title="2.2.3 低品質配列の除去 ‣ 2.2 GSシリーズシーケンサーやIon PGMの場合 ‣ 第2章 塩基配列データの前処理 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2.3</span></a>節に従って低品質配列の除去を行って下さい。</p>
</div>
</section>
<section id="Ch2.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.2 </span>GSシリーズシーケンサーやIon PGMの場合</h3>

<section id="Ch2.S2.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2.1 </span>SFFからFASTQの生成</h4>

<div id="Ch2.S2.SS1.p1" class="ltx_para">
<p class="ltx_p">まずはSFFファイルからFASTQ形式のファイルを作成します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sff_extract -c SFFファイル名↓</span>
          </p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">-c</span>オプションを付けることで、読み始めの<span class="ltx_text ltx_font_typewriter">TCAG</span>が除去されてファイルが作成されます。
もし後述するタグ配列の冒頭に<span class="ltx_text ltx_font_typewriter">TCAG</span>を付けている場合には、このオプションは使用しないで下さい。
SFFファイルが<span class="ltx_text ltx_font_typewriter">HOGEHOGE.sff</span>だとすると、<span class="ltx_text ltx_font_typewriter">HOGEHOGE.fastq</span>というFASTQ形式のファイルとして塩基配列は保存されます。
<span class="ltx_text ltx_font_typewriter">HOGEHOGE.xml</span>というファイルもできますが、ここでは使いませんので削除して構いません。
出力される塩基配列はタグ配列で始まり、解読開始側プライマー配列、解読対象の塩基配列データと続き、反対側プライマー配列(の逆相補配列)で終わります。
ただし、全域が読めるとは限りませんので、途中で読み終わっている配列も含んでいます。
なお、ここでは<span class="ltx_text ltx_font_typewriter">sff_extract</span>コマンドを用いていますが、読み始めの<span class="ltx_text ltx_font_typewriter">TCAG</span>を除いた塩基配列のFASTQ形式ファイルが得られれば、シーケンサーメーカーから提供される純正のコマンドを使っていただいても構いません。
逆に後述する<span class="ltx_text ltx_font_typewriter">clsplitseq</span>に与えるタグ配列の冒頭に<span class="ltx_text ltx_font_typewriter">TCAG</span>を追加していただいても構いませんが、<span class="ltx_text ltx_font_typewriter">TCAG</span>部分の品質値まで厳格にチェックされます。</p>
</div>
</section>
<section id="Ch2.S2.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2.2 </span>塩基配列をサンプルごとに分ける</h4>

<div id="Ch2.S2.SS2.p1" class="ltx_para">
<p class="ltx_p">次に、タグ配列とプライマー配列に基づいてサンプルごとに配列を別々のファイルに分離(demultiplex)します。
事前に以下のようなタグ配列を記したFASTAファイル、解読開始側プライマー配列を記したFASTAファイルがそれぞれ必要です。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;タグID</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| タグ配列</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;examplesample1</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ACGTACGT</span>
            </span>
</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;プライマーID</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| プライマー配列</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;exampleprimer1</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ACGTACGTACGTACGTACGT</span>
            </span>
</p>
<p class="ltx_p">タグ配列には縮重コード表記は使えませんが、プライマー配列には縮重コード表記を利用可能です。
タグ配列、プライマー配列ともに複数の配列を記述しておくことも可能です。
なお、<a href="#Ch1.S1.SS1" title="1.1.1 中間アダプターを用いたコスト抑制方法 ‣ 1.1 タグ・アダプター配列付きプライマーを用いたPCR ‣ 第1章 次世代シーケンサーによる大量サンプルの塩基配列決定 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1.1.1</span></a>節で説明したような中間アダプターを用いたりした場合は、プライマー配列ファイルは以下のような内容で作成して下さい。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;プライマーID</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| 中間アダプター配列プライマー配列</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;exampleprimer1</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TGATACTCGATACGTACGTACGTACGTACGTACGT</span>
            </span>
</p>
<p class="ltx_p">つまり、プライマー配列ファイルには、タグ配列と解読対象の配列の間にある配列を記述して下さい。</p>
</div>
<div id="Ch2.S2.SS2.p2" class="ltx_para">
<p class="ltx_p">これらのファイルが用意できたら、以下のコマンドで塩基配列をサンプルごとに別ファイルへ分割します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clsplitseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--runname=ランID \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--tagfile=タグ配列ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--primerfile=プライマー配列ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqualtag=27 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
<p class="ltx_p">ランIDはランごとに異なるように適当に決めて指定して下さい。
通常はシーケンサーのメーカーが適当に付けているはずなので、それを記述します。
ファイル名やファイル中の配列名などに含まれていますが、メーカーによってルールが異なりプログラムから自動的に取得することが面倒なため、ユーザー側で指定する必要があります。
<span class="ltx_text ltx_font_typewriter">--minqualtag</span>はタグ配列部分の品質値の下限を指定するオプションです。
この値より品質値が低い塩基がタグ配列に含まれる場合は、その配列は出力されません。
品質値27という値は、Roche GSシリーズシーケンサーの読み取りミスをクラスタリング・コンセンサス配列作成によって除去するのに適した値です<cite class="ltx_cite"><a href="#bib.bib11" title="" class="ltx_ref">(Kunin <span class="ltx_text ltx_font_italic">et al</span>., 2010)</a></cite>。
他機種では別の値の方が良い可能性があります。
品質値30がかなり広く使用されていますので、30にしてもいいでしょう。</p>
</div>
<div id="Ch2.S2.SS2.p3" class="ltx_para">
<p class="ltx_p">タグを利用したマルチプレックスシーケンスを行っていない場合、<span class="ltx_text ltx_font_typewriter">--tagfile</span>オプションが不要となりますが、単に省略しただけだとこの後のClaidentのコマンドで処理可能な配列ファイルが作成されません。
そのため、ダミーでも構いませんので<span class="ltx_text ltx_font_typewriter">--indexname=タグID</span>というオプションを付加して実行して下さい。</p>
</div>
<div id="Ch2.S2.SS2.p4" class="ltx_para">
<p class="ltx_p">出力される配列からは、タグとプライマーの配列部分は除去されています。
タグ配列部分の認識は厳密一致です。
1塩基の読み間違いを許すなどのオプションはありません。
プライマー配列の認識は、Needleman-Wunschアルゴリズムを用いたアライメントを行い、14%まで不一致を許容します(閾値は変更可能)。
出力フォルダには、<span class="ltx_text ltx_font_typewriter">ランID__タグID__プライマーID.fastq.gz</span>という名前の塩基配列ファイルが保存されます。
<span class="ltx_text ltx_font_typewriter">clsplitseq</span>では並列処理によって多数のCPUを活かした高速化が可能です。
CPUが4個の場合、<span class="ltx_text ltx_font_typewriter">--numthreads</span>オプションに4を指定すれば最も高速に処理ができるはずです。
ただし、OSやディスクへの書き込み速度がボトルネックになって思うように速度が出ないこともあります。
なお、出力ファイルはGZIPで圧縮されていますので、GZIP圧縮FASTQに対応していないプログラムで読み込むには<span class="ltx_text ltx_font_typewriter">gzip -d</span>などで圧縮を解除しておく必要があります。
これ以降のClaidentのコマンドは対応しているためそのまま使えます。</p>
</div>
<div id="Ch2.S2.SS2.p5" class="ltx_para">
<p class="ltx_p">DDBJ Sequence Read Archive (DRA)など、次世代シーケンサーの生データを登録するサイトには、ここで生成されたGZIP圧縮FASTQを登録します。</p>
</div>
<section id="Ch2.S2.SS2.SSSx1" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">数ラン分に分けて大量サンプルをシーケンスした場合</h5>

<div id="Ch2.S2.SS2.SSSx1.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">clsplitseq</span>による処理を複数回行います。
ただし、<span class="ltx_text ltx_font_typewriter">clsplitseq</span>は出力先フォルダが既に存在しているとエラーになり処理できません。
そこで、2回目以降は<span class="ltx_text ltx_font_typewriter">--append</span>オプションを付けて実行します。
例えば以下のようにして下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clsplitseq \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--runname=ランID \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--tagfile=タグ配列ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--primerfile=プライマー配列ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqualtag=27 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clsplitseq \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--runname=ランID \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--tagfile=タグ配列ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--primerfile=プライマー配列ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqualtag=27 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--append \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル2 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
              </span>
</p>
</div>
</section>
<section id="Ch2.S2.SS2.SSSx2" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">異なる長さのタグが混在している場合について</h5>

<div id="Ch2.S2.SS2.SSSx2.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">clsplitseq</span>では、タグの長さは全て同一であることを仮定しています。
その仮定を使うことで処理を高速化しています。
そのため、タグの長さが不統一の場合は、長さの異なるタグごとに別々のFASTAファイルを準備し、以下のようにして複数回<span class="ltx_text ltx_font_typewriter">clcplitseq</span>による処理を行って下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clsplitseq \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--runname=ランID \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--tagfile=タグ配列ファイル1 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--primerfile=プライマー配列ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqualtag=27 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clsplitseq \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--runname=ランID \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--tagfile=タグ配列ファイル2 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--primerfile=プライマー配列ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqualtag=27 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--append \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
              </span>
</p>
</div>
</section>
<section id="Ch2.S2.SS2.SSSx3" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">リバースプライマー配列の認識と除去</h5>

<div id="Ch2.S2.SS2.SSSx3.p1" class="ltx_para">
<p class="ltx_p">これまでの手順では、リバースプライマー配列がアニールする部分の配列は除去されていません。
これもできれば除去した方が良いでしょう。
それには、まず以下のような内容のリバースプライマー配列のファイルを用意します。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;プライマーID</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| プライマー配列</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;exampleprimer1</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| TCAGTCAGTCAGTCAGTCAG</span>
              </span>
</p>
<p class="ltx_p">配列は複数記述できますが、フォワードプライマーと1対1対応していることを仮定していますので注意して下さい。
フォワードプライマーと配列数が異なるとエラーになります。
配列順序も対応していることを仮定していますので、リバースプライマーは同一でもフォワードプライマーが異なるサンプルがある場合、それぞれ異なるプライマーIDを割り当てて両方記述する必要があります。</p>
</div>
<div id="Ch2.S2.SS2.SSSx3.p2" class="ltx_para">
<p class="ltx_p">ファイルが用意できたら、<span class="ltx_text ltx_font_typewriter">clsplitseq</span>を以下のように実行して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clsplitseq \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--runname=ランID \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--tagfile=タグ配列ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--primerfile=プライマー配列ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--reverseprimerfile=リバースプライマー配列ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--reversecomplement \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqualtag=27 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
              </span>
</p>
<p class="ltx_p">このコマンドでは前述のコマンドの処理に加えて、さらにリバースプライマー逆相補配列をNeedleman-Wunschアルゴリズムを用いたアライメントによって15%まで不一致を許して探します。
該当する配列が見つかったら、該当箇所の先頭以降を元の配列から除去します。
該当する配列が見つからなかった場合は、他の条件を満たしていればそのまま出力ファイルに保存されます。
ただし、読み間違いなどによってリバースプライマーの付く部位以降が除去しきれないこともあります。
なお、<span class="ltx_text ltx_font_typewriter">--needreverseprimer</span>というオプションを追加することで、リバースプライマー逆相補配列に一致する部位が見つからなかった配列は出力されなくなります。
最後まで解読しきれた配列だけにしたい場合はこのオプションを付けて実行してみて下さい。</p>
</div>
</section>
</section>
<section id="Ch2.S2.SS3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2.3 </span>低品質配列の除去</h4>

<div id="Ch2.S2.SS3.p1" class="ltx_para">
<p class="ltx_p">FASTQ形式の塩基配列には、解読時のデータから推定された塩基の品質値がありますので、その情報に基づいて質の低い配列をこの時点である程度除去してしまうことができます。
以下のように<span class="ltx_text ltx_font_typewriter">clfilterseq</span>を実行して下さい。</p>
</div>
<div id="Ch2.S2.SS3.p2" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clfilterseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqual=27 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minquallen=3 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minlen=350 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--maxlen=400 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--maxplowqual=0.1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
            </span>
</p>
</div>
<div id="Ch2.S2.SS3.p3" class="ltx_para">
<p class="ltx_p">ここで、<span class="ltx_text ltx_font_typewriter">--minqual</span>は品質値の下限値で、終末端側からこの値以上の品質値が<span class="ltx_text ltx_font_typewriter">--minquallen</span>の値以上に連続して出現するまで配列を削っていきます。
その上で、<span class="ltx_text ltx_font_typewriter">--minlen</span>の長さ未満の配列は除去し、<span class="ltx_text ltx_font_typewriter">--maxlen</span>より長い場合はこの値になるまで終末端を削ります。
残った配列において、<span class="ltx_text ltx_font_typewriter">--minqual</span>未満の配列が<span class="ltx_text ltx_font_typewriter">--maxplowqual</span>の割合より多い場合はその配列は除去します。
通常は出力はファイルになりますが、<span class="ltx_text ltx_font_typewriter">--output=folder</span>というオプションを与えた場合はフォルダを作成して入力ファイルと同じ名前のファイルに出力します。
既存のフォルダに出力する場合は<span class="ltx_text ltx_font_typewriter">--append</span>を追加して下さい。</p>
</div>
<div id="Ch2.S2.SS3.p4" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">clsplitseq</span>の出力フォルダ内の全配列ファイルに対して同じ処理を行う場合は、以下のようなコマンドを実行して下さい。</p>
</div>
<div id="Ch2.S2.SS3.p5" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; for f in clsplitseqの出力フォルダ/*.fastq.gz↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">do clfilterseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--output=folder \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--append \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqual=27 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minquallen=3 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minlen=350 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--maxlen=400 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--maxplowqual=0.1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">$f \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">done↓</span>
            </span>
</p>
</div>
</section>
</section>
<section id="Ch2.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.3 </span>Illumina社シーケンサーの場合</h3>

<section id="Ch2.S3.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3.1 </span>BCLからFASTQの生成</h4>

<div id="Ch2.S3.SS1.p1" class="ltx_para">
<p class="ltx_p">Illumina社のシーケンサーでは、標準でdemultiplexする機能がありますが、タグ配列部分の品質値を一切見ていないため、タグ配列の品質が低い配列がファイルに含まれています。
このため、生データであるBCLファイルから、Illuminaが配布しているbcl2fastq (1.x系と2.x系はどちらでも構いません)を用いて、demultiplexしていないFASTQ配列を生成し、<span class="ltx_text ltx_font_typewriter">clsplitseq</span>でdemultiplexを行います。
bcl2fastqのインストールは付録に書きましたのでそちらを参照願います。
また、Illumina社のシーケンサーでは300bpのシーケンスでは301bp (150bpのシーケンスでは151bp)のデータが出力されるため、末尾の1塩基は除去する必要があります(何故最初から1塩基除いたデータを出力してくれないのかは知りません)。
下記の例ではbcl2fastqでFASTQ配列生成の際に除去するようになっています。</p>
</div>
<div id="Ch2.S3.SS1.p2" class="ltx_para">
<p class="ltx_p">まず、シーケンサー付属マシンからBaseCallsフォルダを含むランデータフォルダをまるごとbcl2fastqをインストールしたPCへコピーします。
なお、BaseCallsフォルダ内またはランデータフォルダ内に<span class="ltx_text ltx_font_typewriter">SampleSheet.csv</span>が存在する場合は、これをリネームしておく必要があります。</p>
</div>
<div id="Ch2.S3.SS1.p3" class="ltx_para">
<p class="ltx_p">次に、bcl2fastqの1.x系では以下のようにコマンドを実行します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cd BaseCallsフォルダの直上フォルダ↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; configureBclToFastq.pl \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--fastq-cluster-count 0 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--use-bases-mask Y300n,Y8,Y8,Y300n \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--input-dir BaseCallsフォルダ \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--output-dir 出力フォルダ↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; make -j4↓</span>
            </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">--fastq-cluster-count 0</span>でファイルの自動分割機能を無効にし、<span class="ltx_text ltx_font_typewriter">--use-bases-mask Y300n,Y8,Y8,Y300n</span>でフォワード側配列を300bp (末端1bpは切り捨て)、インデックス1 (タグ配列R逆相補)を8bp、インデックス2 (タグ配列F)を8bp、リバース側配列を300bp (末端1bpは切り捨て)とし、それぞれ<span class="ltx_text ltx_font_typewriter">*_R1_001.fastq.gz</span>、<span class="ltx_text ltx_font_typewriter">*_R2_001.fastq.gz</span>、<span class="ltx_text ltx_font_typewriter">*_R3_001.fastq.gz</span>、<span class="ltx_text ltx_font_typewriter">*_R4_001.fastq.gz</span>として出力するよう設定しています。
これはDual Index (インデックスは各8bp)で両側から各300bpずつ解読する(300PE)設定でシーケンスした場合ですので、異なる設定でシーケンスした場合は値を適宜変更して下さい。
Single Index (長さ6bp)で片側250bpの解読を行った場合は<span class="ltx_text ltx_font_typewriter">--use-bases-mask Y250n,Y6</span>となり、Dual Index (長さ各8bp)で片側300bpの場合は<span class="ltx_text ltx_font_typewriter">--use-bases-mask Y300n,Y8,Y8</span>となります。
<span class="ltx_text ltx_font_typewriter">make -j4</span>を実行すると、4つのCPUを使用してBCLからFASTQの生成が行われます。
生成されたFASTQはGZIPというプログラムで圧縮されたものになります。
ファイル名の末尾の拡張子<span class="ltx_text ltx_font_typewriter">.gz</span>はそれを示すものです。
ClaidentはGZIPで圧縮されたFASTQをそのまま扱えるため、圧縮したままで構いません。</p>
</div>
<div id="Ch2.S3.SS1.p4" class="ltx_para">
<p class="ltx_p">bcl2fastqの2.x系を使用している場合は以下のようにコマンドを実行します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; bcl2fastq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--processing-threads 4 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--use-bases-mask Y300n,Y8,Y8,Y300n \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--runfolder-dir ランデータフォルダ \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--output-dir 出力フォルダ↓</span>
            </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">--processing-threads</span>は処理に使用するCPU数を指定するオプションです。
CPUが16個あるPCで専有できるなら16を指定して下さい。
<span class="ltx_text ltx_font_typewriter">--use-bases-mask</span>オプションの意味は1.x系と同じです。
<span class="ltx_text ltx_font_typewriter">--runfolder-dir</span>にはランデータフォルダを指定します。
1.xでは<span class="ltx_text ltx_font_typewriter">--input-dir</span>にBaseCallsフォルダを指定していましたが、2.xでは指定方法が異なりますので注意して下さい。</p>
</div>
</section>
<section id="Ch2.S3.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3.2 </span>塩基配列をサンプルごとに分ける</h4>

<div id="Ch2.S3.SS2.p1" class="ltx_para">
<p class="ltx_p">FASTQファイルができたら、タグ配列とプライマー配列に基づいてサンプルごとに配列を別々のファイルに分離(demultiplex)します。
事前に以下のようなタグ配列を記したFASTAファイル、解読開始側プライマー配列を記したFASTAファイルがそれぞれ必要です。
ペアエンドの場合は、当然リバース側の配列を記したファイルも必要です。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;タグID</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| タグ配列</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;examplesample1</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ACGTACGT</span>
            </span>
</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;プライマーID</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| プライマー配列</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;exampleprimer1</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ACGTACGTACGTACGTACGT</span>
            </span>
</p>
<p class="ltx_p">タグ配列には縮重コード表記は使えませんが、プライマー配列には縮重コード表記を利用可能です。
タグ配列、プライマー配列ともに複数の配列を記述しておくことも可能ですが、フォワードプライマーとリバースプライマーは配列数も配列順序も対応していることを仮定しています。
リバースプライマーは同一でもフォワードプライマーが異なるサンプルがある場合、それぞれ異なるプライマーIDを割り当てて両方記述する必要があります。
タグに関しても同様です。
なお、プライマーの前に<span class="ltx_text ltx_font_typewriter">NNNNNN</span>を付加した場合は、それも含めてプライマーを記述して下さい。
サンプルごとに<span class="ltx_text ltx_font_typewriter">N</span>の長さを変化させている場合は最も長い場合だけを記述して下さい。</p>
</div>
<div id="Ch2.S3.SS2.p2" class="ltx_para">
<p class="ltx_p">これらのファイルが用意できたら、以下のコマンドで塩基配列をサンプルごとに別ファイルへ分割します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clsplitseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--runname=ランID \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--index1file=インデックス1配列(タグ配列R逆相補)ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--index2file=インデックス2配列(タグ配列F)ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--primerfile=プライマー配列ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--reverseprimerfile=リバースプライマー配列ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqualtag=30 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル2 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル3 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル4 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
<p class="ltx_p">入力ファイルは<span class="ltx_text ltx_font_typewriter">*_R1_001.fastq.gz</span>、<span class="ltx_text ltx_font_typewriter">*_R2_001.fastq.gz</span>、<span class="ltx_text ltx_font_typewriter">*_R3_001.fastq.gz</span>、<span class="ltx_text ltx_font_typewriter">*_R4_001.fastq.gz</span>の順で記述して下さい。
<span class="ltx_text ltx_font_typewriter">--index1file</span>はIlluminaが言うところのインデックス1、つまりタグ配列R逆相補を指定し、<span class="ltx_text ltx_font_typewriter">--index2file</span>にはIlluminaが言うところのインデックス2、つまりタグ配列Fを指定して下さい。
逆にしないように注意して下さい。
フォワードプライマーは14%まで、リバースプライマーは15%まで不一致を許容して探します。
なお、プライマーの前に<span class="ltx_text ltx_font_typewriter">NNNNNN</span>を付加した場合は、<span class="ltx_text ltx_font_typewriter">--truncateN=enable</span>を付加して下さい。
このオプションにより、プライマー配列先頭の<span class="ltx_text ltx_font_typewriter">N</span>とデータ配列の対応する部位は削った上で不一致度を算出するようになります。
<span class="ltx_text ltx_font_typewriter">N</span>の長さを変化させていても、その部位を除いて不一致度が算出されるようになるためプライマー配列ファイルには<span class="ltx_text ltx_font_typewriter">N</span>が最長の場合だけを記述しておけば全てヒットするようになります。
処理が終わったら、各ファイルの配列数を確認し、Illumina純正のプログラムでdemultiplexしたファイルの配列数と比較して下さい。
正しく処理できていれば、全てIllumina純正プログラムで処理した場合より少なくなっているはずです。</p>
</div>
<div id="Ch2.S3.SS2.p3" class="ltx_para">
<p class="ltx_p">本来のプライマー配列をシーケンスプライマーとして用いた場合、データ配列にはプライマー配列に当たる部位が含まれていません。
この場合は<span class="ltx_text ltx_font_typewriter">--primerfile</span>と<span class="ltx_text ltx_font_typewriter">--reverseprimerfile</span>オプションが必要ないわけですが、配列の名前をこの後のClaidentのコマンドで処理可能な形式とするためにオプションとして<span class="ltx_text ltx_font_typewriter">--primername=プライマーID</span>を付加して実行して下さい。
ダミーでも構いません。</p>
</div>
<div id="Ch2.S3.SS2.p4" class="ltx_para">
<p class="ltx_p">タグを利用したマルチプレックスシーケンスを行っていない場合、<span class="ltx_text ltx_font_typewriter">--index1file</span>と<span class="ltx_text ltx_font_typewriter">--index2file</span>オプションが不要となりますが、単に省略しただけだとこの後のClaidentのコマンドで処理可能な配列ファイルが作成されません。
そのため、ダミーでも構いませんので<span class="ltx_text ltx_font_typewriter">--indexname=タグID</span>というオプションを付加して実行して下さい。</p>
</div>
<div id="Ch2.S3.SS2.p5" class="ltx_para">
<p class="ltx_p">出力されるファイルは<span class="ltx_text ltx_font_typewriter">ランID__タグID__プライマーID.forward.fastq.gz</span>と<span class="ltx_text ltx_font_typewriter">ランID__タグID__プライマーID.reverse.fastq.gz</span>になります。
DDBJ Sequence Read Archive (DRA)など、次世代シーケンサーの生データを登録するサイトには、ここで生成されたGZIP圧縮FASTQを登録します。
なお、DRAへの登録では配列の長さが揃っているかどうかを指定する箇所がありますが、長さが可変のプライマー部位の配列を除去していますから揃っていません(プライマーセットが1つであってもアライメント時にギャップが入る可能性があるため揃わない)ので誤って揃っていると指定しないようにして下さい。</p>
</div>
</section>
<section id="Ch2.S3.SS3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3.3 </span>フォワード配列とリバース配列の連結</h4>

<section id="Ch2.S3.SS3.SSSx1" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">オーバーラップがある場合</h5>

<div id="Ch2.S3.SS3.SSSx1.p1" class="ltx_para">
<p class="ltx_p">ペアエンドでシーケンスを行った場合には、<span class="ltx_text ltx_font_typewriter">clconcatpair</span>を用いてフォワード配列とリバース配列を連結します。
フォワード配列とリバース配列にオーバーラップがある場合には、以下のように実行することでVSEARCHを呼び出して連結します。</p>
</div>
<div id="Ch2.S3.SS3.SSSx1.p2" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clconcatpair \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--mode=OVL \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力フォルダ \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
              </span>
</p>
</div>
<div id="Ch2.S3.SS3.SSSx1.p3" class="ltx_para">
<p class="ltx_p">以上のコマンドでは、入力フォルダから<span class="ltx_text ltx_font_typewriter">*.forward.fastq</span>と<span class="ltx_text ltx_font_typewriter">*.reverse.fastq</span>を探しだして自動的に連結します。
末尾に<span class="ltx_text ltx_font_typewriter">.gz</span>や<span class="ltx_text ltx_font_typewriter">.bz2</span>が付く圧縮ファイルでも構いません。
出力ファイルは指定したフォルダ内に<span class="ltx_text ltx_font_typewriter">*.fastq.gz</span>として作成されます。</p>
</div>
<div id="Ch2.S3.SS3.SSSx1.p4" class="ltx_para">
<p class="ltx_p">入力ファイル名が<span class="ltx_text ltx_font_typewriter">*.forward.fastq</span>と<span class="ltx_text ltx_font_typewriter">*.reverse.fastq</span>になっていない場合は、以下のように実行することで1組のファイルの配列を連結可能です。</p>
</div>
<div id="Ch2.S3.SS3.SSSx1.p5" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clconcatpair \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--mode=OVL \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル2 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
              </span>
</p>
</div>
<div id="Ch2.S3.SS3.SSSx1.p6" class="ltx_para">
<p class="ltx_p">入力ファイル1にフォワード配列のFASTQファイル、入力ファイル2にリバース配列のFASTQファイルを指定して下さい。出力ファイルは末尾に<span class="ltx_text ltx_font_typewriter">.gz</span>や<span class="ltx_text ltx_font_typewriter">.bz2</span>を付けないと自動的に圧縮はされません。</p>
</div>
</section>
<section id="Ch2.S3.SS3.SSSx2" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">オーバーラップがない場合</h5>

<div id="Ch2.S3.SS3.SSSx2.p1" class="ltx_para">
<p class="ltx_p">フォワード配列とリバース配列間にオーバーラップがない場合には、先に以下のように<span class="ltx_text ltx_font_typewriter">clfilterseq</span>を用いて低品質部位のトリミングや低品質配列の除去を行います。</p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p2" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clfilterseq \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqual=30 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minquallen=3 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minlen=100 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--maxplowqual=0.1 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル2 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
              </span>
</p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p3" class="ltx_para">
<p class="ltx_p">ここで、<span class="ltx_text ltx_font_typewriter">--minqual</span>は品質値の下限値で、終末端側からこの値以上の品質値が<span class="ltx_text ltx_font_typewriter">--minquallen</span>の値以上に連続して出現するまで配列を削っていきます。
その上で、<span class="ltx_text ltx_font_typewriter">--minlen</span>の長さ未満の配列は除去します。
残った配列において、<span class="ltx_text ltx_font_typewriter">--minqual</span>未満の配列が<span class="ltx_text ltx_font_typewriter">--maxplowqual</span>の割合より多い場合はその配列は除去します。
この処理では、ペアエンドのどちらか一方でも除去される場合、ペアとなるもう一方も除去します。
出力はフォルダを作成して入力ファイルと同じ名前のファイルになります。
既存のフォルダに出力する場合は<span class="ltx_text ltx_font_typewriter">--append</span>を追加して下さい。
フォルダ内の全ての<span class="ltx_text ltx_font_typewriter">*.forward.fastq</span>と<span class="ltx_text ltx_font_typewriter">*.reverse.fastq</span>に適用する場合は、以下のように実行して下さい。</p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p4" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; for f in `ls *.forward.fastq.gz | grep -P -o '^[^\.]+'`↓</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">do clfilterseq \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqual=30 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minquallen=3 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minlen=100 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--maxplowqual=0.1 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">$f.forward.fastq.gz \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">$f.reverse.fastq.gz \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">done↓</span>
              </span>
</p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p5" class="ltx_para">
<p class="ltx_p">このように低品質配列を除去した後、以下のように<span class="ltx_text ltx_font_typewriter">clconcatpair</span>を用いて連結を行います。</p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p6" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clconcatpair \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--mode=NON \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力フォルダ \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
              </span>
</p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p7" class="ltx_para">
<p class="ltx_p">この方法では、以下のようなフォワード配列とリバース配列を入力として仮定します。</p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p8" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border-left:0.5em solid #000000;padding:0.5em 1em 0.5em 1em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">5' ― フォワード配列 ― 3'</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">5' ― リバース配列 ― 3'</span>
              </span>
</p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p9" class="ltx_para">
<p class="ltx_p">これらの配列を、<span class="ltx_text ltx_font_typewriter">clconcatpair --mode=NON</span>では以下のように連結します。</p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p10" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border-left:0.5em solid #000000;padding:0.5em 1em 0.5em 1em;">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">5' ― リバース配列(逆相補) ― ACGTACGTACGTACGT ― フォワード配列 ― 3'</span>
            </p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p11" class="ltx_para">
<p class="ltx_p">ノイジー配列とキメラ配列の除去はそのまま通常の連結したペアエンドデータと全く同様に行い、配列のクラスタリングに用いる<span class="ltx_text ltx_font_typewriter">clclassseqv</span>と代表配列への生配列のマッピングを行う<span class="ltx_text ltx_font_typewriter">clrecoverseqv</span>の実行時に<span class="ltx_text ltx_font_typewriter">--paddinglen=16</span>を加えて実行します。
上記の連結では、連結点を後から識別できるように人工配列である<span class="ltx_text ltx_font_typewriter">ACGTACGTACGTACGT</span>を加えているため、配列の類似度が過大になってしまいます。
そこで、完全一致するはずの<span class="ltx_text ltx_font_typewriter">ACGTACGTACGTACGT</span>の長さ分を配列の類似度計算から除外することで正しい配列類似度に基づくクラスタリングを行います。</p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p12" class="ltx_para">
<p class="ltx_p">ホスト生物の同定をする際には、<span class="ltx_text ltx_font_typewriter">ACGTACGTACGTACGT</span>を探して配列を分割し、フォワード配列とリバース配列で別々に同定し、第<a href="#Ch7.S3" title="7.3 複数の同定結果の統合 ‣ 第7章 DNAバーコーディングによる配列のホスト生物同定 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.3</span></a>節の内容に従って2つの同定結果を統合します。
一般にフォワード配列の方が品質が高いはずですので、フォワード配列とリバース配列の分子同定能力や変異性について何も事前情報がない場合はフォワード配列に基づく同定結果を優先する設定で統合するのが良いでしょう。
配列の分割は<span class="ltx_text ltx_font_typewriter">cldivseq</span>を以下のように実行することで行えます。</p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p13" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt;cldivseq \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--query=ACGTACGTACGTACGT \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル1 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル2</span>
              </span>
</p>
</div>
<div id="Ch2.S3.SS3.SSSx2.p14" class="ltx_para">
<p class="ltx_p">出力ファイル1がリバース配列の逆相補配列、出力ファイル2がフォワード配列になります。</p>
</div>
</section>
<section id="Ch2.S3.SS3.SSSx3" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">PEARを用いて連結する場合</h5>

<div id="Ch2.S3.SS3.SSSx3.p1" class="ltx_para">
<p class="ltx_p">フォワード配列とリバース配列にオーバーラップがある場合には、PEAR <cite class="ltx_cite"><a href="#bib.bib19" title="" class="ltx_ref">(Zhang <span class="ltx_text ltx_font_italic">et al</span>., 2014)</a></cite>を用いて連結することもできます。
PEARの場合はdemultiplexした配列ファイルのあるフォルダで、以下のコマンドを実行して下さい。</p>
</div>
<div id="Ch2.S3.SS3.SSSx3.p2" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; pear \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">-p 0.0001 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">-u 0 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">-j 使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">-f ランID__タグID__プライマーID.forward.fastq.gz \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">-r ランID__タグID__プライマーID.reverse.fastq.gz \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">-o ランID__タグID__プライマーID↓</span>
              </span>
</p>
</div>
<div id="Ch2.S3.SS3.SSSx3.p3" class="ltx_para">
<p class="ltx_p">正常に処理が終わると、以下のファイルができます。</p>
</div>
<div id="Ch2.S3.SS3.SSSx3.p4" class="ltx_para">
<dl id="Ch2.I1" class="ltx_description">
<dt id="Ch2.I1.ix1"><span class="ltx_tag ltx_tag_description">
                  <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.assembled.fastq</span>
                </span></dt>
<dd>
<div id="Ch2.I1.ix1.p1" class="ltx_para">
<p class="ltx_p">
                    <span class="ltx_text" style="font-size:90%;">連結された配列</span>
                  </p>
</div>
</dd>
<dt id="Ch2.I1.ix2"><span class="ltx_tag ltx_tag_description">
                  <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.unassembled.forward.fastq</span>
                </span></dt>
<dd>
<div id="Ch2.I1.ix2.p1" class="ltx_para">
<p class="ltx_p">
                    <span class="ltx_text" style="font-size:90%;">連結されなかったフォワード配列</span>
                  </p>
</div>
</dd>
<dt id="Ch2.I1.ix3"><span class="ltx_tag ltx_tag_description">
                  <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.unassembled.reverse.fastq</span>
                </span></dt>
<dd>
<div id="Ch2.I1.ix3.p1" class="ltx_para">
<p class="ltx_p">
                    <span class="ltx_text" style="font-size:90%;">連結されなかったリバース配列</span>
                  </p>
</div>
</dd>
<dt id="Ch2.I1.ix4"><span class="ltx_tag ltx_tag_description">
                  <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.discarded.fastq</span>
                </span></dt>
<dd>
<div id="Ch2.I1.ix4.p1" class="ltx_para">
<p class="ltx_p">
                    <span class="ltx_text" style="font-size:90%;">検定で一致していると判定されなかった配列</span>
                  </p>
</div>
</dd>
</dl>
</div>
<div id="Ch2.S3.SS3.SSSx3.p5" class="ltx_para">
<p class="ltx_p">この後で使用するのは<span class="ltx_text ltx_font_typewriter">ランID__タグID__プライマーID.assembled.fastq</span>だけです。
また、出力は圧縮されていないため、ディスク容量の節約のためにも圧縮しておいた方がいいかもしれません。</p>
</div>
<div id="Ch2.S3.SS3.SSSx3.p6" class="ltx_para">
<p class="ltx_p">なお、フォルダ内の全てのファイルに対してPEARによる連結を連続して行うには、以下のようなコマンドをお使い下さい。</p>
</div>
<div id="Ch2.S3.SS3.SSSx3.p7" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; for f in `ls *.forward.fastq.gz | grep -P -o '^[^\.]+'`↓</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">do pear \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">-p 0.0001 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">-u 0 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">-j 使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">-f $f.forward.fastq.gz \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">-r $f.reverse.fastq.gz \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">-o $f↓</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">done↓</span>
              </span>
</p>
</div>
</section>
<section id="Ch2.S3.SS3.SSSx4" class="ltx_subsubsection">
<h5 class="ltx_title ltx_title_subsubsection">VSEARCHを用いて連結する場合</h5>

<div id="Ch2.S3.SS3.SSSx4.p1" class="ltx_para">
<p class="ltx_p">フォワード配列とリバース配列にオーバーラップがあるなら、直接VSEARCHを用いて連結することも可能です。
以下のようにコマンドを実行して下さい。</p>
</div>
<div id="Ch2.S3.SS3.SSSx4.p2" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; vsearch \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--threads 使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--fastq_mergepairs ランID__タグID__プライマーID.forward.fastq.gz \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--reverse ランID__タグID__プライマーID.reverse.fastq.gz \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--fastq_allowmergestagger \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--fastqout ランID__タグID__プライマーID.assembled.fastq↓</span>
              </span>
</p>
</div>
<div id="Ch2.S3.SS3.SSSx4.p3" class="ltx_para">
<p class="ltx_p">増幅産物長が解読長よりも短い場合、フォワード配列の読み終わりがリバース配列の読み始めを超えてしまったりリバース配列の読み終わりがフォワード配列の読み始めを超えてしまいますが、デフォルトではそのような配列が連結されません。
<span class="ltx_text ltx_font_typewriter">--fastq_allowmergestagger</span>はこれを許して連結するオプションです。
反対側の読み始めを超えてしまったオーバーハング部分は人工配列なので切り捨てられます。
上記のようなケースの可能性がないライブラリを解読した場合は指定する必要はありません。
PEARでは<span class="ltx_text ltx_font_typewriter">--fastq_allowmergestagger</span>を指定した場合と同じ処理がなされます。
PEARと同様に連結できなかった配列を得たい場合は<span class="ltx_text ltx_font_typewriter">--fastqout_notmerged_fwd</span>オプションと<span class="ltx_text ltx_font_typewriter">--fastqout_notmerged_rev</span>オプションに保存先のファイル名を指定して下さい。
そのほか、最小オーバーラップ長を<span class="ltx_text ltx_font_typewriter">--fastq_minovlen</span>で、連結後の最小・最大配列長を<span class="ltx_text ltx_font_typewriter">--fastq_minmergelen</span>・<span class="ltx_text ltx_font_typewriter">--fastq_maxmergelen</span>で、オーバーラップ中の最大許容不一致数を<span class="ltx_text ltx_font_typewriter">--fastq_maxdiffs</span>で、連結後の最大許容期待エラー数を<span class="ltx_text ltx_font_typewriter">--fastq_maxee</span>で指定できます。
<span class="ltx_text ltx_font_typewriter">clconcatpair</span>からVSEARCHを呼び出す場合のデフォルト設定は<span class="ltx_text ltx_font_typewriter">--fastq_minovlen 20 --fastq_maxdiffs 20</span>としていますが、VSEARCHのデフォルトでは<span class="ltx_text ltx_font_typewriter">--fastq_minovlen 10 --fastq_maxdiffs 5</span>となっています。</p>
</div>
<div id="Ch2.S3.SS3.SSSx4.p4" class="ltx_para">
<p class="ltx_p">フォルダ内の全てのファイルに対してVSEARCHによる連結を連続して行うには、以下のようなコマンドをお使い下さい。</p>
</div>
<div id="Ch2.S3.SS3.SSSx4.p5" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; for f in `ls *.forward.fastq.gz | grep -P -o '^[^\.]+'`↓</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">do vsearch \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--threads 使用するCPU数 \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--fastq_mergepairs $f.forward.fastq.gz \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--reverse $f.reverse.fastq.gz \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--fastq_allowmergestagger \</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--fastqout $f.assembled.fastq↓</span>
              </span>
<span class="ltx_p ltx_align_left">
                <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">done↓</span>
              </span>
</p>
</div>
</section>
</section>
<section id="Ch2.S3.SS4" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3.4 </span>低品質配列の除去</h4>

<div id="Ch2.S3.SS4.p1" class="ltx_para">
<p class="ltx_p">FASTQ形式の塩基配列には、解読時のデータから推定された塩基の品質値がありますので、その情報に基づいて質の低い配列をこの時点である程度除去してしまうことができます。
以下のように<span class="ltx_text ltx_font_typewriter">clfilterseq</span>を実行して下さい。</p>
</div>
<div id="Ch2.S3.SS4.p2" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clfilterseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqual=30 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--maxplowqual=0.1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
            </span>
</p>
</div>
<div id="Ch2.S3.SS4.p3" class="ltx_para">
<p class="ltx_p">このコマンドでは、入力配列において<span class="ltx_text ltx_font_typewriter">--minqual</span>未満の配列が<span class="ltx_text ltx_font_typewriter">--maxplowqual</span>の割合より多い場合はその配列を除去します。
通常は出力はファイルになりますが、<span class="ltx_text ltx_font_typewriter">--output=folder</span>というオプションを与えた場合はフォルダを作成して入力ファイルと同じ名前のファイルに出力します。
既存のフォルダに出力する場合は<span class="ltx_text ltx_font_typewriter">--append</span>を追加して下さい。
Illuminaでペアエンドを連結した場合は、両端は品質値が高く、オーバーラップ部分も一致していれば品質値が高くなりますので、末端から品質値の低い配列を削るのはあまり意味がありません。
連結したペアエンドではこのように品質値が低い配列が一定量を超えた配列を除去するのがよいでしょう。
もちろん、既存のFASTQの品質確認を行うプログラムを利用されてもいいと思います。
そのようなプログラムとしては、FastQC <cite class="ltx_cite"><a href="#bib.bib2" title="" class="ltx_ref">(Andrews, 2010)</a></cite>やPRINSEQ <cite class="ltx_cite"><a href="#bib.bib16" title="" class="ltx_ref">(Schmieder and Edwards, 2011)</a></cite>があります。</p>
</div>
<div id="Ch2.S3.SS4.p4" class="ltx_para">
<p class="ltx_p">PEARで連結した全配列ファイルに対して同じ処理を行う場合は、以下のようなコマンドを実行して下さい。</p>
</div>
<div id="Ch2.S3.SS4.p5" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; for f in *.assembled.fastq↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">do clfilterseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--output=folder \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--append \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minqual=30 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--maxplowqual=0.1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">$f \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">done↓</span>
            </span>
</p>
</div>
<div id="Ch2.S3.SS4.p6" class="ltx_para">
<p class="ltx_p">VSEARCHの機能を用いて、品質値に基づいた配列全体での期待エラー数に上限を設定したフィルタリングも可能です。
これは以下のようなコマンドで適用できます。</p>
</div>
<div id="Ch2.S3.SS4.p7" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; vsearch \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--threads 使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--fastq_filter 入力ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--fastq_maxee 1.0 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--fastqout 出力ファイル↓</span>
            </span>
</p>
</div>
<div id="Ch2.S3.SS4.p8" class="ltx_para">
<p class="ltx_p">片側だけのシーケンスデータや、連結していないデータの場合は、Roche GSシリーズシーケンサやIon PGMの場合と同様の処理を行えばいいと思います。
第<a href="#Ch2.S2.SS3" title="2.2.3 低品質配列の除去 ‣ 2.2 GSシリーズシーケンサーやIon PGMの場合 ‣ 第2章 塩基配列データの前処理 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2.2.3</span></a>節をご参照下さい。
ただし、品質値や長さの閾値は適宜変更する必要があると思います。</p>
</div>
</section>
</section>
<section id="Ch2.S4" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.4 </span>同じ鋳型を複数回PCRまたは複数回シーケンスした場合について</h3>

<div id="Ch2.S4.p1" class="ltx_para">
<p class="ltx_p">キメラ配列はPCRによって生成されますので、同一PCR由来配列なのか、異なるPCR由来配列なのかをプログラムに正しく認識させなくてはなりません。
そのため、同じ鋳型を複数回PCRまたは複数回シーケンスした場合には、プログラムがデータを正しく扱えるようにいくつかの操作が必要になります。
なお、ここでは、Nested PCRや、増幅のためのPCRとタグ配列付加のためのPCRはまとめて1回と数えることに注意して下さい。
つまり、ここで「複数回PCR」とは、「増幅産物を鋳型にしてさらにPCRで増幅する」ことではなく、「同じ鋳型を使用したPCR」を複数回行うことです。</p>
</div>
<section id="Ch2.S4.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4.1 </span>同じ鋳型を複数回PCRして同じタグ配列を付加して同じランでシーケンスした場合</h4>

<div id="Ch2.S4.SS1.p1" class="ltx_para">
<p class="ltx_p">実験デザインが間違っており、複数回PCRを活かしたキメラ検出・除去は行えません。
通常の1回のPCRと同様にしか扱えません。</p>
</div>
</section>
<section id="Ch2.S4.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4.2 </span>同じ鋳型を複数回PCRして別のタグ配列を付加して同じランでシーケンスした場合</h4>

<div id="Ch2.S4.SS2.p1" class="ltx_para">
<p class="ltx_p">ClaidentではサンプルID=ランID__タグID__プライマーIDですから、同じ鋳型由来のサンプルが複数存在するデータとなります。
わざと別サンプルのままにしておいて、1つ以上のサンプルで出現しないOTUはキメラや読み間違い(PCRの合成ミスも含む)のある配列と判断するというのも良い考えだと思います。
ただ、キメラの生成や読み間違いがランダムであればこれはベストな方法でしょうが、できやすいキメラや起きやすい読み間違いというものがもしあれば(あるはずです)、同一のキメラ配列・読み間違いのある配列が全サンプルに出現する可能性があります。
この方法がどの程度正確かという情報はまだ十分ではありませんので、プログラムによるキメラ検出も併用した方が良いかもしれません。
この方法の効果を調べた研究<cite class="ltx_cite"><a href="#bib.bib12" title="" class="ltx_ref">(Lange <span class="ltx_text ltx_font_italic">et al</span>., 2015)</a></cite>も参照して下さい。
この方法はClaidentでサポートしているため実施方法は後述します。
サンプルごとの各OTUの配列数の集計表をこの後で作成しますが、集計表の加工コマンド<span class="ltx_text ltx_font_typewriter">clfiltersum</span>により複数のサンプルを統合して1サンプルにすることが可能です(各OTUの配列数は和になります)。</p>
</div>
</section>
<section id="Ch2.S4.SS3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4.3 </span>同じ鋳型を1回PCRして同じタグ配列を付加して複数のランでシーケンスした場合</h4>

<div id="Ch2.S4.SS3.p1" class="ltx_para">
<p class="ltx_p">1回のランでは、たまたま得られる配列が少ないことがあります。
そのため同一サンプルを複数のランでシーケンスし、全ランのデータを使いたいことがあります。
ClaidentではサンプルID=ランID__タグID__プライマーIDですから、同じ鋳型由来のサンプルが複数存在するデータとなります。
そのような場合はそのまま別サンプルとして解析を進めることもできますし、1サンプルにまとめてから解析を進めることもできます。
別サンプルのまま処理を進める方を推奨します。
そして、サンプルごとの各OTUの配列数の集計表を作成する際に複数のサンプルを統合して1サンプルにまとめて下さい(各OTUの配列数は和になります)。
後者の方法では旧パイプラインによる解析でサンプルごとにキメラ検出を行うことが可能ですが、それ以外特にメリットはありません。</p>
</div>
<div id="Ch2.S4.SS3.p2" class="ltx_para">
<p class="ltx_p">同じ鋳型由来の複数サンプルを別サンプルのまま解析を進めた場合、サンプルごとの各OTUの配列数の集計表を作成後に集計表の加工コマンド<span class="ltx_text ltx_font_typewriter">clfiltersum</span>により複数のサンプルを統合して1サンプルにまとめて下さい(各OTUの配列数は和になります)。</p>
</div>
<div id="Ch2.S4.SS3.p3" class="ltx_para">
<p class="ltx_p">同じ鋳型由来の複数サンプルを1つのサンプルに統合してからこの後の解析に進む場合は、以下のように処理して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clsplitseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">オプション省略 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--runname=HOGEHOGE \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clsplitseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">オプション省略 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--runname=HOGEHOGE \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--append \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル2 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
<p class="ltx_p">このように<span class="ltx_text ltx_font_typewriter">--runname</span>オプションでランIDを置換し、2つの入力ファイルのラン名を同一にしてやることで、2つのファイルからの同一サンプルからの配列が<span class="ltx_text ltx_font_typewriter">HOGEHOGE__タグID__プライマーID.fastq.gz</span>という1つのファイルに書き出されます。</p>
</div>
<div id="Ch2.S4.SS3.p4" class="ltx_para">
<p class="ltx_p">ClaidentではランIDとタグIDとプライマーIDが同じなら、同一PCR産物=同一サンプルの配列として扱います。
PCRが1回でタグ配列ファイルとプライマー配列ファイルが同じなら、当然タグIDとプライマーIDは同じになっているはずですので、ランIDも同じにしてしまうことで、同一PCR産物の配列として認識させることができるようになります。</p>
</div>
</section>
<section id="Ch2.S4.SS4" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4.4 </span>同じ鋳型を複数回PCRして同じタグ配列を付加して別々のランでシーケンスした場合</h4>

<div id="Ch2.S4.SS4.p1" class="ltx_para">
<p class="ltx_p">複数ラン分の配列ファイルがあるはずですので、<span class="ltx_text ltx_font_typewriter">clsplitseq</span>によるサンプルごとの配列の分別と<span class="ltx_text ltx_font_typewriter">clfilterseq</span>による低品質配列の除去を別々に実行し、別々のフォルダに出力します。
この後のノイジー配列とキメラ配列の除去も別々に行い、クラスタリングの際に複数ラン分のデータをまとめて入力ファイルとして与えて下さい。
そして、サンプルごとの各OTUの配列数の集計表を作成する際に複数のサンプルを統合して1サンプルにまとめて下さい(各OTUの配列数は和になります)。</p>
</div>
</section>
<section id="Ch2.S4.SS5" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4.5 </span>同じ鋳型を複数回PCRして異なるタグ配列を付加して別々のランでシーケンスした場合</h4>

<div id="Ch2.S4.SS5.p1" class="ltx_para">
<p class="ltx_p">1回のランでは、たまたま得られる配列が少ないことがあります。
そのため同一サンプルを複数のランでシーケンスし、全ランのデータを使いたいことがあります。
ClaidentではサンプルID=ランID__タグID__プライマーIDですから、同じ鋳型由来のサンプルが複数存在するデータとなります。
そのような場合はそのまま別サンプルとして解析を進めることもできますし、1サンプルにまとめてから解析を進めることもできます。
別サンプルのまま処理を進め、ノイジー配列とキメラ配列の除去の際に「同じ鋳型由来の複数のPCR産物に共通に出現しない塩基配列はキメラもしくはノイジー配列とみなす」方法を適用することを推奨します。
そして、サンプルごとの各OTUの配列数の集計表を作成する際に複数のサンプルを統合して1サンプルにまとめて下さい(各OTUの配列数は和になります)。</p>
</div>
<div id="Ch2.S4.SS5.p2" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">clsplitseq</span>は、複数の配列ファイルがあるはずですので以下のように実行して下さい。
ここではファイルが2つの場合を示します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clsplitseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">オプション省略 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--tagfile=タグ配列ファイル1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--primerfile=プライマー配列ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clsplitseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">オプション省略 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--tagfile=タグ配列ファイル2 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--primerfile=プライマー配列ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--append \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル2 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
<p class="ltx_p">プライマー配列ファイル、出力フォルダは同じものを与えて下さい。
<span class="ltx_text ltx_font_typewriter">--runname</span>オプションでは異なるランIDを指定します。
また、タグ配列ファイルは個別に用意して与えて下さい。
ただし、同じ鋳型由来の配列に付加したタグIDは同じにして下さい。
配列が同じタグであっても、異なる鋳型由来の配列に付加したタグのIDを同一にしてはいけません。
例えば以下の2ファイルを用意したとします。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;sample1</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ACGTACGT</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;sample2</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ATGCATGC</span>
            </span>
</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;sample1</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ATGCATGC</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| &gt;sample2</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| ACGTACGT</span>
            </span>
</p>
<p class="ltx_p">この場合、sample1の鋳型には1ラン目には<span class="ltx_text ltx_font_typewriter">ACGTACGT</span>を付加し、2ラン目では<span class="ltx_text ltx_font_typewriter">ATGCATGC</span>を付加したことになります。
sample2の鋳型では逆になります。
もしも、ほぼ同じ領域を増幅してはいるがプライマー配列は異なる場合、タグと同様に同じIDを付けた別々のファイルを用意して与えて下さい。
この後の解析に関しては後述します。</p>
</div>
</section>
</section>
</section>
<section id="Ch3" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第3章 </span>重複配列カウントによるノイジー配列とキメラ配列の除去</h2>

<div id="Ch3.p1" class="ltx_para">
<p class="ltx_p">Claidentでは、配列のクラスタリング結果から読み間違いの多いノイジーな配列を推定して除去することができます。
方法はCD-HIT-OTU <cite class="ltx_cite"><a href="#bib.bib14" title="" class="ltx_ref">(Li <span class="ltx_text ltx_font_italic">et al</span>., 2012)</a></cite>とほとんど同じです。
また、旧パイプラインではVSEARCHに実装されたUCHIME <cite class="ltx_cite"><a href="#bib.bib5" title="" class="ltx_ref">(Edgar <span class="ltx_text ltx_font_italic">et al</span>., 2011)</a></cite>アルゴリズムを呼び出して結果を受け取ることで、キメラ配列の検出・除去も可能です。
新パイプラインでは、クラスタリング処理が終わってからキメラ検出・除去処理を適用します。</p>
</div>
<section id="Ch3.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3.1 </span>VSEARCHを用いた新パイプラインの場合</h3>

<div id="Ch3.S1.p1" class="ltx_para">
<p class="ltx_p">以下のコマンドでノイジー配列の検出・除去が行えます。
なお、多数のファイルを一度に与えることができますが、できるだけ1ラン分のファイルを与えて下さい。
これは、ランごとに塩基配列決定の質にばらつきがあるためです。
1ラン分の配列が非常に多く(1000万超)時間がかかってしまう場合は、1サンプルごとにこの処理を行って下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clcleanseqv \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--derepmode=PREFIX \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--primarymaxnmismatch=0 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--secondarymaxnmismatch=1 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--pnoisycluster=0.5 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイルN \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
          </span>
</p>
<p class="ltx_p">オプションのうち、<span class="ltx_text ltx_font_typewriter">--derepmode</span>は前処理において全長一致(<span class="ltx_text ltx_font_typewriter">FULLLENGTH</span>)で配列をまとめるか、前方一致(<span class="ltx_text ltx_font_typewriter">PREFIX</span>)で配列をまとめるかを指定します。
オーバーラップのあるペアエンド配列を連結して得られた配列を処理する場合は<span class="ltx_text ltx_font_typewriter">FULLLENGTH</span>を、シングルエンド配列を処理する場合は<span class="ltx_text ltx_font_typewriter">PREFIX</span>を指定して下さい。
<span class="ltx_text ltx_font_typewriter">--primarymaxnmismatch</span>はプライマリクラスタリングで許容するミスマッチ数で通常は0にします。
<span class="ltx_text ltx_font_typewriter">--secondarymaxnmismatch</span>はセカンダリクラスタリングで許容するミスマッチ数で、通常は1にします。
ただし、「先頭から末尾までに読み間違いが全くない配列」がほとんどないと思われるようなあまりにもノイズの多いデータでは、<span class="ltx_text ltx_font_typewriter">--primarymaxnmismatch</span>を1に、<span class="ltx_text ltx_font_typewriter">--secondarymaxnmismatch</span>を3にしてみて下さい。
それでもダメなら<span class="ltx_text ltx_font_typewriter">--primarymaxnmismatch</span>を2に、<span class="ltx_text ltx_font_typewriter">--secondarymaxnmismatch</span>を5にして試します。
<span class="ltx_text ltx_font_typewriter">--secondarymaxnmismatch</span>は<span class="ltx_text ltx_font_typewriter">--primarymaxnmismatch</span>の2倍より1大きい値に設定して下さい。
<span class="ltx_text ltx_font_typewriter">--pnoisycluster</span>はノイジー配列と判定する感度に関するオプションです。
0以上1以下で指定して下さい。
大きいほど感度が上がります。
デフォルト値・推奨値は0.5です。
クラスタリングを最終的に97%以下の閾値で行うのであればこれでいいと思いますが、99%前後でクラスタリングする場合、<span class="ltx_text ltx_font_typewriter">--pnoisycluster</span>は0.9くらいにするといいかもしれません。
ただし、レアOTUを捨ててしまう可能性が高くなるので、1サンプル当たりの配列数を多めに読んでおく必要があります。</p>
</div>
<div id="Ch3.S1.p2" class="ltx_para">
<p class="ltx_p">出力フォルダには、以下のファイル群が保存されます。</p>
<dl id="Ch3.I1" class="ltx_description">
<dt id="Ch3.I1.ix1"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">parameter.txt</span>
            </span></dt>
<dd>
<div id="Ch3.I1.ix1.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">プライマリクラスタをノイジーと判定するのに使用した所属配列数の下限値</span>
              </p>
</div>
</dd>
<dt id="Ch3.I1.ix2"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">primarycluster.denoised.fasta.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I1.ix2.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ノイジーと判定されなかったプライマリクラスタの代表配列</span>
              </p>
</div>
</dd>
<dt id="Ch3.I1.ix3"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">primarycluster.fasta.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I1.ix3.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">プライマリクラスタの代表配列</span>
              </p>
</div>
</dd>
<dt id="Ch3.I1.ix4"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">secondarycluster.fasta.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I1.ix4.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">セカンダリクラスタの代表配列</span>
              </p>
</div>
</dd>
<dt id="Ch3.I1.ix5"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.noisyreads.txt.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I1.ix5.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ノイジー配列と判定された配列のリスト</span>
              </p>
</div>
</dd>
<dt id="Ch3.I1.ix6"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.singletons.txt.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I1.ix6.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">プライマリクラスタリングでシングルトンになった配列のリスト</span>
              </p>
</div>
</dd>
</dl>
<p class="ltx_p">他にも多くのファイルが出力されますが、後の解析に必要なものもありますので削除しないようにして下さい。</p>
</div>
<section id="Ch3.S1.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1.1 </span>PCRレプリケート法によるノイジー配列・キメラ配列の除去</h4>

<div id="Ch3.S1.SS1.p1" class="ltx_para">
<p class="ltx_p">PCRレプリケートを用意してノイジー配列・キメラ配列を検出・除去するには、まず同一鋳型DNA由来のPCRレプリケートはどのサンプルとどのサンプルなのかを記したファイルを用意する必要があります。
以下のような内容で用意して下さい。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| sample1  sample2  sample3</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| sample4  sample5</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| sample6  sample7</span>
            </span>
</p>
<p class="ltx_p">同一の行内にタブ区切りで書かれたサンプルが、同一鋳型由来のPCRレプリケートであることを表しています。
異なる鋳型由来のサンプルは別の行に記述して下さい。
PCRレプリケートは3つ以上あっても構いません。
また、レプリケート数が鋳型ごとに異なっても構いません。</p>
</div>
<div id="Ch3.S1.SS1.p2" class="ltx_para">
<p class="ltx_p">上記ファイルが用意できたら、以下のように<span class="ltx_text ltx_font_typewriter">clcleanseqv</span>を実行することでレプリケート間で共通しないプライマリクラスタをキメラもしくはノイジーであると判断して除去します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clcleanseqv \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--replicatelist=PCRレプリケート指示ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--derepmode=PREFIX \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--primarymaxnmismatch=0 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--secondarymaxnmismatch=1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--pnoisycluster=0.5 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイルN \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
<p class="ltx_p">レプリケートが3つ以上であっても、全てのレプリケートで検出されたプライマリクラスタのみがノイジーでもキメラでもないと判断されます。
また、1つのプライマリクラスタが複数の鋳型から検出されていた場合、どれか1つの鋳型でノイジーまたはキメラと判定されていれば、他の鋳型でもノイジーまたはキメラとみなして除去します。
これらの設定は以下のオプションで変更することができます。</p>
<dl id="Ch3.I2" class="ltx_description">
<dt id="Ch3.I2.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minnreplicate</span>
              </span></dt>
<dd>
<div id="Ch3.I2.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">整数値で指定。
この値以上のレプリケートで観測されたプライマリクラスタはそのサンプルではノイジーでもキメラでもないと見なす。
デフォルト値は</span>
                  <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">2</span>
                  <span class="ltx_text" style="font-size:90%;">。</span>
                </p>
</div>
</dd>
<dt id="Ch3.I2.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minpreplicate</span>
              </span></dt>
<dd>
<div id="Ch3.I2.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">小数値で指定。
プライマリクラスタが観測されたレプリケート数/サンプルの総レプリケート数がこの値以上であれば、そのサンプルではノイジーでもキメラでもないと見なす。
デフォルト値は</span>
                  <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1</span>
                  <span class="ltx_text" style="font-size:90%;">。</span>
                </p>
</div>
</dd>
<dt id="Ch3.I2.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minnpositive</span>
              </span></dt>
<dd>
<div id="Ch3.I2.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">整数値で指定。
この値以上の配列(サンプルではない)がノイジーまたはキメラと判定されていれば、全サンプルでノイジーまたはキメラと見なす。
デフォルト値は</span>
                  <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1</span>
                  <span class="ltx_text" style="font-size:90%;">。</span>
                </p>
</div>
</dd>
<dt id="Ch3.I2.ix4"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minppositive</span>
              </span></dt>
<dd>
<div id="Ch3.I2.ix4.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">小数値で指定。
ノイジーまたはキメラと判定された配列数/プライマリクラスタの総配列数がこの値以上であれば、全サンプルでノイジーまたはキメラと見なす。
デフォルト値は</span>
                  <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span>
                  <span class="ltx_text" style="font-size:90%;">。</span>
                </p>
</div>
</dd>
<dt id="Ch3.I2.ix5"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--runname</span>
              </span></dt>
<dd>
<div id="Ch3.I2.ix5.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">ランIDを指定。
サンプル名に含まれるランIDが全てこれに置換される。
同一サンプル名になったサンプルは統合される。</span>
                </p>
</div>
</dd>
</dl>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">--minnreplicate</span>と<span class="ltx_text ltx_font_typewriter">--minpreplicate</span>の値に基づく1サンプル内での判定と、<span class="ltx_text ltx_font_typewriter">--minnpositive</span>と<span class="ltx_text ltx_font_typewriter">--minppositive</span>の値に基づく全サンプルにまたがる判定が2段階で行われていることに注意して下さい。
前者では2つの条件を両方満たすとノイジーでもキメラでもないと判定され、後者では2つの条件を両方満たすとノイジーまたはキメラであると判定されます。
また、同一のプライマリクラスタが、あるサンプルではノイジーまたはキメラだが、別のサンプルではそうでない、といった判定は行えません。
最終的な判定は全サンプル共通です。
また、PCRレプリケート指示ファイルに記されていないサンプルでは判定が行われません。</p>
</div>
<div id="Ch3.S1.SS1.p3" class="ltx_para">
<p class="ltx_p">上記のように<span class="ltx_text ltx_font_typewriter">clcleanseqv</span>を実行すると、以下のようなファイルも出力フォルダに保存されます。</p>
<dl id="Ch3.I3" class="ltx_description">
<dt id="Ch3.I3.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">primarycluster.chimeraremoved.fasta.gz</span>
              </span></dt>
<dd>
<div id="Ch3.I3.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">キメラと判定されなかったプライマリクラスタの代表配列</span>
                </p>
</div>
</dd>
<dt id="Ch3.I3.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">primarycluster.cleaned.fasta.gz</span>
              </span></dt>
<dd>
<div id="Ch3.I3.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">ノイジーでもキメラでもないと判定されたプライマリクラスタの代表配列</span>
                </p>
</div>
</dd>
<dt id="Ch3.I3.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.chimericreads.txt.gz</span>
              </span></dt>
<dd>
<div id="Ch3.I3.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">キメラ配列と判定された配列のリスト</span>
                </p>
</div>
</dd>
</dl>
</div>
</section>
</section>
<section id="Ch3.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3.2 </span>Assamsを用いた旧パイプラインの場合</h3>

<div id="Ch3.S2.p1" class="ltx_para">
<p class="ltx_p">以下のコマンドでノイジー配列とキメラ配列の検出・除去が行えます。
なお、多数のファイルを一度に与えることができますが、できるだけ1ラン分のファイルを与えて下さい。
これは、ランごとに塩基配列決定の質にばらつきがあるためです1ラン分の配列が非常に多く(100万超)時間がかかってしまう場合は、1サンプルごとにこの処理を行って下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clcleanseq \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">uchime --minh 0.1 --mindiv 0.8 end \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--detectmode=N+C \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--pnoisycluster=0.5 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイルN \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
          </span>
</p>
<p class="ltx_p">オプションのうち、<span class="ltx_text ltx_font_typewriter">uchime</span>から<span class="ltx_text ltx_font_typewriter">end</span>の間はUCHIMEの実行オプションです。
<span class="ltx_text ltx_font_typewriter">--minh</span>と<span class="ltx_text ltx_font_typewriter">--mindiv</span>はキメラ配列と判定する感度に関するオプションです。
<span class="ltx_text ltx_font_typewriter">--minh</span>は値が小さいほど感度が高くなります。
UCHIMEの作者は0.1以上5以下の範囲にするよう推奨しています。
デフォルト値は0.1です。
<span class="ltx_text ltx_font_typewriter">--mindiv</span>の指定値が0.8の場合、0.8%以下の違いしかない配列間はキメラが形成されていても無視されます。
最終的に97%一致規準で配列をクラスタリングするとしたら、2%程度の違いしかない配列間のキメラはクラスタリング・コンセンサス配列作成によって潰されるため、この値を大きくすることで計算が速くなります。
また、<span class="ltx_text ltx_font_typewriter">--pnoisycluster</span>はノイジー配列と判定する感度に関するオプションです。
0以上1以下で指定して下さい。
大きいほど感度が上がります。
デフォルト値・推奨値は0.5です。
クラスタリングを最終的に97%以下の閾値で行うのであればこれでいいと思いますが、99%前後でクラスタリングする場合、<span class="ltx_text ltx_font_typewriter">--pnoisycluster</span>は0.9くらいにするといいかもしれません。
ただし、レアOTUを捨ててしまう可能性が高くなるので、1サンプル当たりの配列数を多めに読んでおく必要があります。</p>
</div>
<div id="Ch3.S2.p2" class="ltx_para">
<p class="ltx_p">各入力ファイルは同一の鋳型を同一のチューブ内でPCRした配列群を含んでいる必要があります。
Claidentがキメラ検出に利用しているUCHIMEでは、元配列数が多いコンセンサス配列ほどPCR当初から存在した＝キメラではないと仮定し、元配列数が少ないコンセンサス配列が、より元配列数の多いコンセンサス配列の部分配列の組み合わせで説明できるかどうかを検討します。
したがって、UCHIMEに「同一の鋳型を同一のチューブ内でPCRした配列群内でのコンセンサス配列の元配列数」を正確に伝える必要があるため、1ファイルは同一の鋳型を同一のチューブ内でPCRした配列群でなくてはならないのです。
これは1ラン分のファイルを一度に与えることよりもはるかに優先度が高いので、同一の鋳型を同一のチューブ内でPCRしたサンプルを複数回のランで塩基配列決定した場合などは複数ラン分のデータを入力しても構いません。</p>
</div>
<div id="Ch3.S2.p3" class="ltx_para">
<p class="ltx_p">UCHIMEによるキメラ判定はそれぞれのサンプルごとに行われ、複数のサンプルで観測されている完全一致配列の場合、どれか1つのサンプルでキメラと判定されていれば、他のサンプルでもキメラとみなして除去します。
ただし、下記のオプションでこの動作を変更することができます。
両オプションの両方を満たせばキメラと判定されます。</p>
<dl id="Ch3.I4" class="ltx_description">
<dt id="Ch3.I4.ix1"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minnpositive</span>
            </span></dt>
<dd>
<div id="Ch3.I4.ix1.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">整数値で指定。
この値以上の配列(サンプルではない)がキメラと判定されていれば、全サンプルでキメラと見なす。
デフォルト値は</span>
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1</span>
                <span class="ltx_text" style="font-size:90%;">。</span>
              </p>
</div>
</dd>
<dt id="Ch3.I4.ix2"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minppositive</span>
            </span></dt>
<dd>
<div id="Ch3.I4.ix2.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">小数値で指定。
キメラと判定された配列数/完全一致した全配列数がこの値以上であれば、全サンプルでキメラと見なす。
デフォルト値は</span>
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span>
                <span class="ltx_text" style="font-size:90%;">。</span>
              </p>
</div>
</dd>
</dl>
<p class="ltx_p">出力フォルダには、以下のファイル群が保存されます。</p>
<dl id="Ch3.I5" class="ltx_description">
<dt id="Ch3.I5.ix1"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.chimeraremoved.dereplicated.fastq.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I5.ix1.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">キメラ配列除去し完全一致配列をまとめた配列</span>
              </p>
</div>
</dd>
<dt id="Ch3.I5.ix2"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.chimeraremoved.fastq.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I5.ix2.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">キメラ配列除去した配列</span>
              </p>
</div>
</dd>
<dt id="Ch3.I5.ix3"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.denoised.dereplicated.fastq.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I5.ix3.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ノイジー配列除去し完全一致配列をまとめた配列</span>
              </p>
</div>
</dd>
<dt id="Ch3.I5.ix4"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.denoised.fastq.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I5.ix4.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ノイジー配列除去した配列</span>
              </p>
</div>
</dd>
<dt id="Ch3.I5.ix5"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.cleaned.dereplicated.fastq.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I5.ix5.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">キメラ配列とノイジー配列を除去し完全一致配列をまとめた配列</span>
              </p>
</div>
</dd>
<dt id="Ch3.I5.ix6"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.cleaned.fastq.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I5.ix6.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">キメラ配列とノイジー配列を除去した配列</span>
              </p>
</div>
</dd>
<dt id="Ch3.I5.ix7"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.chimericreads.txt.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I5.ix7.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">キメラ配列と判定された配列のリスト</span>
              </p>
</div>
</dd>
<dt id="Ch3.I5.ix8"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.noisyreads.txt.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I5.ix8.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ノイジー配列と判定された配列のリスト</span>
              </p>
</div>
</dd>
<dt id="Ch3.I5.ix9"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.singletons.txt.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I5.ix9.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">完全一致配列をまとめたときにシングルトンになった配列のリスト</span>
              </p>
</div>
</dd>
<dt id="Ch3.I5.ix10"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.uchime.txt.gz</span>
            </span></dt>
<dd>
<div id="Ch3.I5.ix10.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">UCHIMEによるキメラ判定結果のログ</span>
              </p>
</div>
</dd>
<dt id="Ch3.I5.ix11"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">ランID__タグID__プライマーID.parameter.txt</span>
            </span></dt>
<dd>
<div id="Ch3.I5.ix11.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">まとまった完全一致配列をノイジーと判定するのに使用した所属配列数の下限値</span>
              </p>
</div>
</dd>
</dl>
<p class="ltx_p">他にも多くのファイルが出力されますが、後の解析に必要なものもありますので削除しないようにして下さい。
キメラ配列除去を無効化してノイジー配列除去のみを行う場合は<span class="ltx_text ltx_font_typewriter">--detectmode=noise</span>、逆にノイジー配列除去を無効化してキメラ配列除去のみを行う場合は<span class="ltx_text ltx_font_typewriter">--detectmode=chimera</span>オプションを付けて実行して下さい。
ただし、<span class="ltx_text ltx_font_typewriter">--detectmode=noise</span>で処理した結果を<span class="ltx_text ltx_font_typewriter">--detectmode=chimera</span>で処理しても、一度にノイジー配列・キメラ配列除去を行った場合(<span class="ltx_text ltx_font_typewriter">--detectmode=N+C</span>を指定した場合またはデフォルト設定)と結果は一致しませんのでご注意下さい。
処理する場合は同時に行う必要があります。
これは、キメラ配列もノイジー配列と判定するための情報を持っており、同時処理の場合にはそれを利用するためです。</p>
</div>
<section id="Ch3.S2.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2.1 </span>PCRレプリケート法によるノイジー配列・キメラ配列の除去</h4>

<div id="Ch3.S2.SS1.p1" class="ltx_para">
<p class="ltx_p">PCRレプリケートを用意してノイジー配列・キメラ配列を検出・除去するには、まず同一鋳型DNA由来のPCRレプリケートはどのサンプルとどのサンプルなのかを記したファイルを用意する必要があります。
以下のような内容で用意して下さい。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| sample1  sample2  sample3</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| sample4  sample5</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| sample6  sample7</span>
            </span>
</p>
<p class="ltx_p">同一の行内にタブ区切りで書かれたサンプルが、同一鋳型由来のPCRレプリケートであることを表しています。
異なる鋳型由来のサンプルは別の行に記述して下さい。
PCRレプリケートは3つ以上あっても構いません。
また、レプリケート数が鋳型ごとに異なっても構いません。</p>
</div>
<div id="Ch3.S2.SS1.p2" class="ltx_para">
<p class="ltx_p">上記ファイルが用意できたら、以下のように<span class="ltx_text ltx_font_typewriter">clcleanseq</span>を実行することでレプリケート間で共通しないプライマリクラスタをキメラもしくはノイジーであると判断して除去します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clcleanseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--replicatelist=PCRレプリケート指示ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">uchime --minh 0.1 --mindiv 0.8 end \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--detectmode=N+C \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--pnoisycluster=0.5 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイルN \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
<p class="ltx_p">レプリケートが3つ以上であっても、全てのレプリケートで検出されたプライマリクラスタのみがノイジーでもキメラでもないと判断されます。
また、1つのプライマリクラスタが複数の鋳型から検出されていた場合、どれか1つの鋳型でノイジーまたはキメラと判定されていれば、他の鋳型でもノイジーまたはキメラとみなして除去します。
これらの設定は以下のオプションで変更することができます。</p>
<dl id="Ch3.I6" class="ltx_description">
<dt id="Ch3.I6.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minnreplicate</span>
              </span></dt>
<dd>
<div id="Ch3.I6.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">整数値で指定。
この値以上のレプリケートで観測されたプライマリクラスタはそのサンプルではノイジーでもキメラでもないと見なす。
デフォルト値は</span>
                  <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">2</span>
                  <span class="ltx_text" style="font-size:90%;">。</span>
                </p>
</div>
</dd>
<dt id="Ch3.I6.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minpreplicate</span>
              </span></dt>
<dd>
<div id="Ch3.I6.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">小数値で指定。
プライマリクラスタが観測されたレプリケート数/サンプルの総レプリケート数がこの値以上であれば、そのサンプルではノイジーでもキメラでもないと見なす。
デフォルト値は</span>
                  <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1</span>
                  <span class="ltx_text" style="font-size:90%;">。</span>
                </p>
</div>
</dd>
<dt id="Ch3.I6.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minnpositive</span>
              </span></dt>
<dd>
<div id="Ch3.I6.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">整数値で指定。
この値以上の配列(サンプルではない)がノイジーまたはキメラと判定されていれば、全サンプルでノイジーまたはキメラと見なす。
デフォルト値は</span>
                  <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1</span>
                  <span class="ltx_text" style="font-size:90%;">。</span>
                </p>
</div>
</dd>
<dt id="Ch3.I6.ix4"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minppositive</span>
              </span></dt>
<dd>
<div id="Ch3.I6.ix4.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">小数値で指定。
ノイジーまたはキメラと判定された配列数/プライマリクラスタの総配列数がこの値以上であれば、全サンプルでノイジーまたはキメラと見なす。
デフォルト値は</span>
                  <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span>
                  <span class="ltx_text" style="font-size:90%;">。</span>
                </p>
</div>
</dd>
<dt id="Ch3.I6.ix5"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--runname</span>
              </span></dt>
<dd>
<div id="Ch3.I6.ix5.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">ランIDを指定。
サンプル名に含まれるランIDが全てこれに置換される。
同一サンプル名になったサンプルは統合される。</span>
                </p>
</div>
</dd>
</dl>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">--minnreplicate</span>と<span class="ltx_text ltx_font_typewriter">--minpreplicate</span>の値に基づく1サンプル内での判定と、<span class="ltx_text ltx_font_typewriter">--minnpositive</span>と<span class="ltx_text ltx_font_typewriter">--minppositive</span>の値に基づく全サンプルにまたがる判定が2段階で行われていることに注意して下さい。
前者では2つの条件を両方満たすとノイジーでもキメラでもないと判定され、後者では2つの条件を両方満たすとノイジーまたはキメラであると判定されます。
また、同一のプライマリクラスタが、あるサンプルではノイジーまたはキメラだが、別のサンプルではそうでない、といった判定は行えません。
最終的な判定は全サンプル共通です。
また、PCRレプリケート指示ファイルに記されていないサンプルでは判定が行われません。</p>
</div>
</section>
</section>
</section>
<section id="Ch4" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第4章 </span>塩基配列クラスタリングに基づくOTUピッキング</h2>

<section id="Ch4.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4.1 </span>サンプル内での配列クラスタリング</h3>

<section id="Ch4.S1.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1.1 </span>VSEARCHを用いた新パイプラインの場合</h4>

<div id="Ch4.S1.SS1.p1" class="ltx_para">
<p class="ltx_p">新パイプラインではこのステップはありません。</p>
</div>
</section>
<section id="Ch4.S1.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1.2 </span>Assamsを用いた旧パイプラインの場合</h4>

<div id="Ch4.S1.SS2.p1" class="ltx_para">
<p class="ltx_p">以下のコマンドで、同一の鋳型を同一のチューブ内でPCRした配列群のクラスタリングを行います。
前節の結果得られる、完全一致配列をまとめた結果(<span class="ltx_text ltx_font_typewriter">ランID__タグID__プライマーID.cleaned.dereplicated.fastq.gz</span>)を入力します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clclassseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minident=0 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--strand=plus \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイルN \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
<p class="ltx_p">前節の出力ファイルに対してこの処理を適用する場合、以下のようにコマンドを打てばいいでしょう。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clclassseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minident=0 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--strand=plus \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">"前節の出力フォルダ/*.cleaned.dereplicated.fastq.gz" \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
<p class="ltx_p">オプションのうち、<span class="ltx_text ltx_font_typewriter">--minident=0</span>は不一致が1塩基以下の配列をまとめる設定です(実際には、類似度が(最短配列の長さ-11/最短配列の長さ-10)以上の配列をまとめます。
最長配列の長さが400bpで最短配列の長さが350bpなら、0.997となり、400bpの配列でも1塩基しか不一致は許容されませんので意図通りになりますが、最短配列と最長配列の差が大きすぎると意図した通りになりません。
そのため、最短配列は最長配列の半分より11塩基以上長くなくてはなりません)。
最終的に97%で配列をまとめる場合もこの時点では0にしておくのがおすすめです。
最終的に99%でまとめる場合にもここでは0にしておきます。
<span class="ltx_text ltx_font_typewriter">--strand=plus</span>は同一ストランドの比較だけでクラスタリングを行うオプションです。
片側からしか読んでいないので、両ストランドの比較をする必要はなく、比較するとかえって異常なクラスタリングをしかねません。
両側から読んでいる場合も、連結した後はストランドは揃っているのでこれでいいはずです。
出力フォルダ内の<span class="ltx_text ltx_font_typewriter">*.assembled.fastq.gz</span>がクラスタリング後の配列です。</p>
</div>
</section>
</section>
<section id="Ch4.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4.2 </span>サンプル間での配列クラスタリング</h3>

<section id="Ch4.S2.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2.1 </span>VSEARCHを用いた新パイプラインの場合</h4>

<div id="Ch4.S2.SS1.p1" class="ltx_para">
<p class="ltx_p">塩基配列のクラスタリングを行ってOTUを作成するには、以下のコマンドを実行して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clclassseqv \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minident=0.97 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイルN \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
<p class="ltx_p">入力ファイルには、<span class="ltx_text ltx_font_typewriter">clcleanseqv</span>の実行時にPCRレプリケート法によるノイジー配列・キメラ配列の除去を併用した場合は<span class="ltx_text ltx_font_typewriter">primarycluster.cleaned.fasta.gz</span>を、併用しなかった場合には<span class="ltx_text ltx_font_typewriter">primarycluster.denoised.fasta.gz</span>を与えて下さい。
オーバーラップのないペアエンドデータを<span class="ltx_text ltx_font_typewriter">clconcatpair</span>を用いて連結した配列では、<span class="ltx_text ltx_font_typewriter">--paddinglen=16</span>をオプションとして加えて実行して下さい。</p>
</div>
<div id="Ch4.S2.SS1.p2" class="ltx_para">
<p class="ltx_p">出力フォルダには、以下のファイルが保存されています。</p>
<dl id="Ch4.I1" class="ltx_description">
<dt id="Ch4.I1.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">clustered.otu.gz</span>
              </span></dt>
<dd>
<div id="Ch4.I1.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">どの生配列がどのOTUに割り当てられたかを記録しているファイル</span>
                </p>
</div>
</dd>
<dt id="Ch4.I1.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">clustered.fasta.gz</span>
              </span></dt>
<dd>
<div id="Ch4.I1.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">OTUの代表配列</span>
                </p>
</div>
</dd>
</dl>
</div>
</section>
<section id="Ch4.S2.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2.2 </span>Assamsを用いた旧パイプラインの場合</h4>

<div id="Ch4.S2.SS2.p1" class="ltx_para">
<p class="ltx_p">サンプル内クラスタリングデータを用いてサンプル間でのクラスタリングを行い、全体のクラスタリング結果を得るには以下のコマンドを実行します。
1サンプルしかない場合も、上記のサンプル内配列クラスタリングを行ってからこの処理を行って下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clclassclass \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minident=0 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--strand=plus \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイルN \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ1↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clreclassclass \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minident=0.99 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--strand=plus \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ2↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clreclassclass \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minident=0.97 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--strand=plus \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ2 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ3↓</span>
            </span>
</p>
<p class="ltx_p">ここでの入力ファイルは前節の出力ファイル<span class="ltx_text ltx_font_typewriter">*.assembled.fastq.gz</span>です。
したがって、実際には以下のように入力することになるでしょう。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clclassclass \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minident=0 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--strand=plus \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">"前節の出力フォルダ/*.assembled.fastq.gz" \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ1↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clreclassclass \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minident=0.99 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--strand=plus \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ2↓</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clreclassclass \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minident=0.97 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--strand=plus \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ2 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ3↓</span>
            </span>
</p>
<p class="ltx_p">1つ目の<span class="ltx_text ltx_font_typewriter">clclassclass</span>でサンプル内配列クラスタリングでまとめられた配列において、不一致が1塩基以下の配列をまとめます。
2つ目の<span class="ltx_text ltx_font_typewriter">clreclassclass</span>で、99%以上一致する配列をまとめ直します。
さらに3つ目の<span class="ltx_text ltx_font_typewriter">clreclassclass</span>で、97%以上一致する配列をまとめ直します。
こうすることで、より高速に、より正確にクラスタリングが行われます。
<span class="ltx_text ltx_font_typewriter">clreclassclass</span>を使用せずに<span class="ltx_text ltx_font_typewriter">clclassclass</span>に97%でまとめるよう指示してしまうと、アルゴリズム上「まとめすぎ」が発生しやすくなります。</p>
</div>
<div id="Ch4.S2.SS2.p2" class="ltx_para">
<p class="ltx_p">出力フォルダには、以下のファイルが保存されています。</p>
<dl id="Ch4.I2" class="ltx_description">
<dt id="Ch4.I2.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">assembled.contigmembers.gz</span>
              </span></dt>
<dd>
<div id="Ch4.I2.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">どの生配列がどのOTUに割り当てられたかを記録しているファイル</span>
                </p>
</div>
</dd>
<dt id="Ch4.I2.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">assembled.fastq.gz</span>
              </span></dt>
<dd>
<div id="Ch4.I2.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">OTUのコンセンサス配列</span>
                </p>
</div>
</dd>
<dt id="Ch4.I2.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">assembled.fasta</span>
              </span></dt>
<dd>
<div id="Ch4.I2.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">OTUのコンセンサス配列</span>
                </p>
</div>
</dd>
</dl>
</div>
</section>
</section>
<section id="Ch4.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4.3 </span>OTU代表配列への生配列のマッピング</h3>

<div id="Ch4.S3.p1" class="ltx_para">
<p class="ltx_p">ノイジー配列・キメラ配列と判定されてしまった配列でも、OTUの代表配列に対して指定した類似度の閾値で貼り付けることが可能なのであれば、復活させることができます。
これにより、データの減少を抑えることができます。</p>
</div>
<section id="Ch4.S3.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3.1 </span>VSEARCHを用いた新パイプラインの場合</h4>

<div id="Ch4.S3.SS1.p1" class="ltx_para">
<p class="ltx_p">以下のコマンドを実行して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clrecoverseqv \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minident=0.97 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--centroid=OTU代表配列のファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイルN \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
<p class="ltx_p">OTU代表配列のファイルには<span class="ltx_text ltx_font_typewriter">clclassseqv</span>の出力した<span class="ltx_text ltx_font_typewriter">clustered.fasta.gz</span>を用います。
入力ファイルとしては、<span class="ltx_text ltx_font_typewriter">clcleanseqv</span>の出力した<span class="ltx_text ltx_font_typewriter">primarycluster.fasta.gz</span>または<span class="ltx_text ltx_font_typewriter">clcleanseqv</span>での処理や低品質配列の除去を行う前の配列ファイルを使用して下さい。
出力フォルダには、<span class="ltx_text ltx_font_typewriter">clclassseqv</span>と同様のファイル群が作成されます。
なお、オーバーラップのないペアエンドデータを<span class="ltx_text ltx_font_typewriter">clconcatpair</span>を用いて連結した配列では、<span class="ltx_text ltx_font_typewriter">--paddinglen=16</span>をオプションとして加えて実行して下さい。</p>
</div>
</section>
<section id="Ch4.S3.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3.2 </span>Assamsを用いた旧パイプラインの場合</h4>

<div id="Ch4.S3.SS2.p1" class="ltx_para">
<p class="ltx_p">旧パイプラインではこのステップはありません。</p>
</div>
</section>
</section>
</section>
<section id="Ch5" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第5章 </span>OTUピッキング結果の要約と後処理</h2>

<section id="Ch5.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.1 </span>集計表の作成</h3>

<div id="Ch5.S1.p1" class="ltx_para">
<p class="ltx_p">以下のコマンドで、クラスタリング結果から各サンプルにおける各OTUに割り当てられた生配列数を表にすることができます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clsumclass \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--output=Matrix \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p">ここでの入力ファイルは、クラスタリング結果の出力フォルダに保存されている、<span class="ltx_text ltx_font_typewriter">clustered.otu.gz</span> (新パイプライン)または<span class="ltx_text ltx_font_typewriter">assembled.contigmembers.gz</span> (旧パイプライン)というファイルです。
出力されるファイルは表<a href="#Ch5.T1" title="表 5.1 ‣ 5.1 集計表の作成 ‣ 第5章 OTUピッキング結果の要約と後処理 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>のようなタブ区切りのテキストファイルで、Excelなどの表計算ソフトやRで読み込むことができます。
ただし、表計算ソフトは巨大な行列の全てを読み込むことができない可能性がありますので注意して下さい。
このファイルに基づいて、群集生態学的な解析を行うことができます。</p>
</div>
<figure id="Ch5.T1" class="ltx_table">
<table class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">samplename</span>
              </th>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">amongsampleotu_1</span>
              </td>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">amongsampleotu_2</span>
              </td>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">amongsampleotu_3</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">
                <span class="ltx_text" style="font-size:80%;">sampleA</span>
              </th>
<td class="ltx_td ltx_align_right ltx_border_tt">
                <span class="ltx_text" style="font-size:80%;">2371</span>
              </td>
<td class="ltx_td ltx_align_right ltx_border_tt">
                <span class="ltx_text" style="font-size:80%;">0</span>
              </td>
<td class="ltx_td ltx_align_right ltx_border_tt">
                <span class="ltx_text" style="font-size:80%;">0</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">sampleB</span>
              </th>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">0</span>
              </td>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">1518</span>
              </td>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">0</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">sampleC</span>
              </th>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">1398</span>
              </td>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">0</span>
              </td>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">0</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">sampleD</span>
              </th>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">0</span>
              </td>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">1436</span>
              </td>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">0</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">sampleE</span>
              </th>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">0</span>
              </td>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">0</span>
              </td>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">1360</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">sampleF</span>
              </th>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">0</span>
              </td>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">0</span>
              </td>
<td class="ltx_td ltx_align_right">
                <span class="ltx_text" style="font-size:80%;">977</span>
              </td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">表 5.1: </span>集計表の例 — 数値は各サンプルにおける各OTUの観測配列数です。</figcaption>
</figure>
</section>
<section id="Ch5.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.2 </span>集計表からの特定のOTU・サンプルの除去</h3>

<div id="Ch5.S2.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">clsumclass</span>では、1回だけ出現した配列も含めて全て出力されますが、以下のコマンドを用いてサンプルやOTUを選別することができます。
入力ファイルは<span class="ltx_text ltx_font_typewriter">clsumclass</span>の出力ファイルです。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clfiltersum \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">オプション \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p">使用できるオプションは以下の通りです。</p>
<dl id="Ch5.I1" class="ltx_description">
<dt id="Ch5.I1.ix1"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minnseqotu</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix1.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">整数値で指定。
この値に基づいて「割り当てられた生配列数がどのサンプルでも指定値未満のOTU」を除去します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix2"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minpseqotu</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix2.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">小数値で指定。
この値に基づいて「割り当てられた生配列数/サンプルの生配列総数がどのサンプルでも指定値未満のOTU」を除去します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix3"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minntotalseqotu</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix3.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">整数値で指定。
この値に基づいて「割り当てられた生配列総数が指定値未満のOTU」を除去します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix4"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minnseqsample</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix4.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">整数値で指定。
この値に基づいて「どのOTUの生配列数も指定値未満のサンプル」を除去します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix5"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minpseqsample</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix5.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">小数値で指定。
この値に基づいて「そのサンプルのそのOTUに割り当てられた生配列数/OTUの生配列総数がどのOTUでも指定値未満のサンプル」を除去します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix6"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minntotalseqsample</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix6.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">整数値で指定。
この値に基づいて「生配列総数が指定値未満のサンプル」を除去します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix7"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--otu</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix7.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">残したいOTU名をカンマで区切って指定します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix8"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--negativeotu</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix8.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">除去したいOTU名をカンマで区切って指定します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix9"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--otulist</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix9.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ファイル名を指定。
1行に1つのOTU名を記したテキストファイルとして残したいOTU名を指定します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix10"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--negativeotulist</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix10.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ファイル名を指定。
1行に1つのOTU名を記したテキストファイルとして除去したいOTU名を指定します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix11"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--otuseq</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix11.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ファイル名を指定。
FASTA形式の配列ファイルとして残したいOTU名を指定します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix12"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--negativeotuseq</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix12.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ファイル名を指定。
FASTA形式の配列ファイルとして除去したいOTU名を指定します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix13"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--sample</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix13.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">残したいサンプル名をカンマで区切って指定します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix14"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--negativesample</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix14.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">除去したいサンプル名をカンマで区切って指定します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix15"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--samplelist</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix15.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ファイル名を指定。
1行に1つのサンプル名を記したテキストファイルとして残したいサンプル名を指定します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix16"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--negativesamplelist</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix16.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ファイル名を指定。
1行に1つのサンプル名を記したテキストファイルとして除去したいサンプル名を指定します。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix17"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--replicatelist</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix17.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ファイル名を指定。
PCRレプリケート関係にあるサンプルをタブ区切りで同一行に記述する。
出力で1つのサンプルに統合される。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I1.ix18"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--runname</span>
            </span></dt>
<dd>
<div id="Ch5.I1.ix18.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ランIDを指定。
集計表中のサンプル名に含まれるランIDが全てこれに置換される。
同一サンプル名になったサンプルは統合される。</span>
              </p>
</div>
</dd>
</dl>
</div>
<div id="Ch5.S2.p2" class="ltx_para">
<p class="ltx_p">後述するノイジー配列・キメラ配列の除去や他領域配列の除去を行った上で、残った配列を用いて<span class="ltx_text ltx_font_typewriter">--otuseq</span>などのオプションを用いたOTUの選別を行う場合は、他の選別より先に行って下さい。</p>
</div>
</section>
<section id="Ch5.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.3 </span>PCRレプリケート法によるノイジー配列・キメラ配列の除去</h3>

<div id="Ch5.S3.p1" class="ltx_para">
<p class="ltx_p">新パイプラインでは<span class="ltx_text ltx_font_typewriter">clcleanseqv</span>の実行時に行っていますが、旧パイプラインでもPCRレプリケートを用意してノイジー配列・キメラ配列を検出・除去することが可能です。
それには、まず同一鋳型DNA由来のPCRレプリケートはどのサンプルとどのサンプルなのかを記したファイルを用意する必要があります。
以下のような内容で用意して下さい。</p>
<p class="ltx_p ltx_align_left" style="background-color:#E6E6E6;padding-top:12pt;padding-bottom:12pt;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| sample1  sample2  sample3</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| sample4  sample5</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">| sample6  sample7</span>
          </span>
</p>
<p class="ltx_p">同一の行内にタブ区切りで書かれたサンプルが、同一鋳型由来のPCRレプリケートであることを表しています。
異なる鋳型由来のサンプルは別の行に記述して下さい。
PCRレプリケートは3つ以上あっても構いません。
また、レプリケート数が鋳型ごとに異なっても構いません。</p>
</div>
<div id="Ch5.S3.p2" class="ltx_para">
<p class="ltx_p">上記ファイルが用意できたら、以下のコマンドでクラスタリング結果からレプリケート間で共通しない配列を除去します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clfilterseq \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--contigmembers=*.contigmembers.gz \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--replicatelist=PCRレプリケート指示ファイル \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p">レプリケートが3つ以上であっても、全てのレプリケートで検出された配列のみがノイジーでもキメラでもないと判断されます。
また、1つのOTUが複数の鋳型から検出されていた場合、どれか1つの鋳型でノイジーまたはキメラと判定されていれば、他の鋳型でもノイジーまたはキメラとみなして除去します。
これらの設定は以下のオプションで変更することができます。</p>
<dl id="Ch5.I2" class="ltx_description">
<dt id="Ch5.I2.ix1"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minnreplicate</span>
            </span></dt>
<dd>
<div id="Ch5.I2.ix1.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">整数値で指定。
この値以上のレプリケートで観測されたOTUはそのサンプルではノイジーでもキメラでもないと見なす。
デフォルト値は</span>
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">2</span>
                <span class="ltx_text" style="font-size:90%;">。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I2.ix2"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minpreplicate</span>
            </span></dt>
<dd>
<div id="Ch5.I2.ix2.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">小数値で指定。
OTUが観測されたレプリケート数/サンプルの総レプリケート数がこの値以上であれば、そのサンプルではノイジーでもキメラでもないと見なす。
デフォルト値は</span>
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1</span>
                <span class="ltx_text" style="font-size:90%;">。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I2.ix3"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minnpositive</span>
            </span></dt>
<dd>
<div id="Ch5.I2.ix3.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">整数値で指定。
この値以上の配列(サンプルではない)がノイジーまたはキメラと判定されていれば、全サンプルでノイジーまたはキメラと見なす。
デフォルト値は</span>
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1</span>
                <span class="ltx_text" style="font-size:90%;">。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I2.ix4"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--minppositive</span>
            </span></dt>
<dd>
<div id="Ch5.I2.ix4.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">小数値で指定。
ノイジーまたはキメラと判定された配列数/OTUの総配列数がこの値以上であれば、全サンプルでノイジーまたはキメラと見なす。
デフォルト値は</span>
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span>
                <span class="ltx_text" style="font-size:90%;">。</span>
              </p>
</div>
</dd>
<dt id="Ch5.I2.ix5"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">--runname</span>
            </span></dt>
<dd>
<div id="Ch5.I2.ix5.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">ランIDを指定。
サンプル名に含まれるランIDが全てこれに置換される。
同一サンプル名になったサンプルは統合される。</span>
              </p>
</div>
</dd>
</dl>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">--minnreplicate</span>と<span class="ltx_text ltx_font_typewriter">--minpreplicate</span>の値に基づく1サンプル内での判定と、<span class="ltx_text ltx_font_typewriter">--minnpositive</span>と<span class="ltx_text ltx_font_typewriter">--minppositive</span>の値に基づく全サンプルにまたがる判定が2段階で行われていることに注意して下さい。
前者では2つの条件を両方満たすとノイジーでもキメラでもないと判定され、後者では2つの条件を両方満たすとノイジーまたはキメラであると判定されます。
また、同一のOTUが、あるサンプルではノイジーまたはキメラだが、別のサンプルではそうでない、といった判定は行えません。
最終的な判定は全サンプル共通です。
また、PCRレプリケート指示ファイルに記されていないサンプルでは判定が行われません。</p>
</div>
<div id="Ch5.S3.p3" class="ltx_para">
<p class="ltx_p">ここで作成したFASTA配列ファイルを第<a href="#Ch5.S2" title="5.2 集計表からの特定のOTU・サンプルの除去 ‣ 第5章 OTUピッキング結果の要約と後処理 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>節の<span class="ltx_text ltx_font_typewriter">clfiltersum</span>の<span class="ltx_text ltx_font_typewriter">--otuseq</span>オプションに指定して集計表を加工することで、この配列ファイルから除去されたOTUを集計表からも除去することができます。
また、<span class="ltx_text ltx_font_typewriter">--replicatelist</span>オプションと<span class="ltx_text ltx_font_typewriter">--runname</span>オプションを<span class="ltx_text ltx_font_typewriter">clfilterseq</span>と同様に指定すれば、PCRレプリケート関係にあるサンプルは1つのサンプルに統合されます(セルの値は合算されます)。</p>
</div>
</section>
<section id="Ch5.S4" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.4 </span>UCHIMEによるキメラ配列除去</h3>

<div id="Ch5.S4.p1" class="ltx_para">
<p class="ltx_p">旧パイプラインではクラスタリング前にもUCHIMEでキメラ配列除去は行っていますが、クラスタリング後の配列に対してリファレンスなしでのキメラ配列除去とリファレンスありでのキメラ配列除去を追加で行うことができます。
両方行う場合は、リファレンスなしでのキメラ配列除去を先に行ってから、リファレンスありでのキメラ配列除去を行います。
両方のキメラ配列除去を行う場合は、クラスタリング前のノイジー配列・キメラ配列除去において、キメラ配列除去を無効にしてもいいかもしれません。
クラスタリング後のキメラ配列除去の方がずっと高速なので、1サンプル当たりの配列が膨大でクラスタリング前のキメラ配列除去では長時間を要する場合には、この方法の方が適しています。
なお、PCRレプリケート法によるノイジー配列・キメラ配列の除去も併用する場合は、PCRレプリケート法によるノイジー配列・キメラ配列の除去を最初に行います。
利用するコマンドは<span class="ltx_text ltx_font_typewriter">clrunuchime</span>です。
このコマンドでは、UCHIMEアルゴリズムを実装しているVSEARCHというプログラムを呼び出して、キメラ配列除去を行います。</p>
</div>
<section id="Ch5.S4.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4.1 </span>リファレンスなしでのキメラ配列除去</h4>

<div id="Ch5.S4.SS1.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">clrunuchime</span>を以下のように実行して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clrunuchime \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--contigmembers=*.contigmembers.gz \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--otufile=*.otu.gz \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
<p class="ltx_p">旧パイプラインを使用した場合は<span class="ltx_text ltx_font_typewriter">--contigmembers</span>オプションを、新パイプラインを使用した場合は<span class="ltx_text ltx_font_typewriter">--otufile</span>オプションを使用します。
上記の例は一度に説明するためのもので、両方を指定してはいけません。
なお、どちらも指定しなかった場合、<span class="ltx_text ltx_font_typewriter">*.otu.gz</span>が入力ファイルと同じフォルダに存在すればそれを、<span class="ltx_text ltx_font_typewriter">*.contigmembers.gz</span>が存在すればそれを見つけ出して使用しますので、普段は何も指定しなくてもいいでしょう。</p>
</div>
</section>
<section id="Ch5.S4.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4.2 </span>リファレンスありでのキメラ配列除去</h4>

<div id="Ch5.S4.SS2.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">clrunuchime</span>を以下のように実行して下さい。
リファレンスなしでのキメラ配列除去を行った場合は、<span class="ltx_text ltx_font_typewriter">nonchimeras.fasta</span>というファイルがあるはずですので、それを入力ファイルにすればいいでしょう。</p>
</div>
<div id="Ch5.S4.SS2.p2" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clrunuchime \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--referencedb=リファレンスデータベース名 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
</div>
<div id="Ch5.S4.SS2.p3" class="ltx_para">
<p class="ltx_p">UCHIME用のリファレンスデータベース名と内容は以下の通りです。</p>
</div>
<div id="Ch5.S4.SS2.p4" class="ltx_para">
<dl id="Ch5.I3" class="ltx_description">
<dt id="Ch5.I3.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">rdpgoldv9</span>
              </span></dt>
<dd>
<div id="Ch5.I3.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">細菌16S用のRDP Goldデータベース(v9版)</span>
                </p>
</div>
</dd>
<dt id="Ch5.I3.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">unite20160101</span>
              </span></dt>
<dd>
<div id="Ch5.I3.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">真菌ITS用のUNITEデータベース(20160101版)</span>
                </p>
</div>
</dd>
<dt id="Ch5.I3.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">unite20160101untrim</span>
              </span></dt>
<dd>
<div id="Ch5.I3.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">真菌ITS用のUNITEデータベース(20160101トリミングなし版)</span>
                </p>
</div>
</dd>
<dt id="Ch5.I3.ix4"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">unite20160101its1</span>
              </span></dt>
<dd>
<div id="Ch5.I3.ix4.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">真菌ITS用のUNITEデータベース(20160101ITS1版)</span>
                </p>
</div>
</dd>
<dt id="Ch5.I3.ix5"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">unite20160101its2</span>
              </span></dt>
<dd>
<div id="Ch5.I3.ix5.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">真菌ITS用のUNITEデータベース(20160101ITS2版)</span>
                </p>
</div>
</dd>
</dl>
</div>
</section>
<section id="Ch5.S4.SS3" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4.3 </span>出力フォルダの内容について</h4>

<div id="Ch5.S4.SS3.p1" class="ltx_para">
<p class="ltx_p">出力フォルダに保存されるファイルは以下の4つです。</p>
</div>
<div id="Ch5.S4.SS3.p2" class="ltx_para">
<dl id="Ch5.I4" class="ltx_description">
<dt id="Ch5.I4.ix1"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">chimeras.fasta</span>
              </span></dt>
<dd>
<div id="Ch5.I4.ix1.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">キメラと判定された配列</span>
                </p>
</div>
</dd>
<dt id="Ch5.I4.ix2"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">nonchimeras.fasta</span>
              </span></dt>
<dd>
<div id="Ch5.I4.ix2.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">キメラでないと判定された配列</span>
                </p>
</div>
</dd>
<dt id="Ch5.I4.ix3"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">uchimealns.txt</span>
              </span></dt>
<dd>
<div id="Ch5.I4.ix3.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">判定時のアライメント</span>
                </p>
</div>
</dd>
<dt id="Ch5.I4.ix4"><span class="ltx_tag ltx_tag_description">
                <span class="ltx_text" style="font-size:90%;">uchimeout.txt</span>
              </span></dt>
<dd>
<div id="Ch5.I4.ix4.p1" class="ltx_para">
<p class="ltx_p">
                  <span class="ltx_text" style="font-size:90%;">判定時の親配列やスコアなど</span>
                </p>
</div>
</dd>
</dl>
</div>
<div id="Ch5.S4.SS3.p3" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">uchimeout.txt</span>の各項目の意味は
<br class="ltx_break"><a href="http://drive5.com/usearch/manual/uchimeout.html" title="" class="ltx_ref">http://drive5.com/usearch/manual/uchimeout.html</a>
<br class="ltx_break">をご覧下さい。</p>
</div>
</section>
</section>
<section id="Ch5.S5" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.5 </span>配列からの低頻度出現配列の除去</h3>

<div id="Ch5.S5.p1" class="ltx_para">
<p class="ltx_p">クラスタリングの出力フォルダには、<span class="ltx_text ltx_font_typewriter">clustered.fasta.gz</span> (新パイプライン)または<span class="ltx_text ltx_font_typewriter">assembled.fasta</span> (旧パイプライン)というファイルとして、最終的に得られた代表配列もしくはコンセンサス配列が保存されています。
これを次章のDNAバーコーディングに用いますが、全サンプルを通して少量しか出現しないものまで含めると数が多すぎることがあります。
そこで、以下のようにして5配列以上出現するものだけを抽出することができます。
配列数の閾値を適当に変えてもいいでしょう。
この閾値は慎重に決定して下さい。
ノイジー配列・キメラ配列の除去を行なっている場合には必要ないかもしれません。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clfilterseq \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--contigmembers=*.contigmembers.gz \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--otufile=*.otu.gz \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minnseq=5 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p">旧パイプラインを使用した場合は<span class="ltx_text ltx_font_typewriter">--contigmembers</span>オプションを、新パイプラインを使用した場合は<span class="ltx_text ltx_font_typewriter">--otufile</span>オプションを使用します。
上記の例は一度に説明するためのもので、両方を指定してはいけません。
なお、どちらも指定しなかった場合、<span class="ltx_text ltx_font_typewriter">*.otu.gz</span>が入力ファイルと同じフォルダに存在すればそれを、<span class="ltx_text ltx_font_typewriter">*.contigmembers.gz</span>が存在すればそれを見つけ出して使用しますので、普段は何も指定しなくてもいいでしょう。
ここで作成したFASTA配列ファイルを第<a href="#Ch5.S2" title="5.2 集計表からの特定のOTU・サンプルの除去 ‣ 第5章 OTUピッキング結果の要約と後処理 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>節の<span class="ltx_text ltx_font_typewriter">clfiltersum</span>の<span class="ltx_text ltx_font_typewriter">--otuseq</span>オプションに指定して集計表を加工することで、この配列ファイルから除去されたOTUを集計表からも除去することができます。</p>
</div>
</section>
<section id="Ch5.S6" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.6 </span>保存領域配列認識による領域分割</h3>

<div id="Ch5.S6.p1" class="ltx_para">
<p class="ltx_p">ここまでの配列が複数領域にまたがっている場合(たとえばITS1・5.8S rRNA・ITS2といった風に)、領域ごとに分割した方が良いかもしれません。
領域間かその付近に保存的な領域があれば、それを境界の目印として領域を分割できます。
特にユニバーサルプライマー配列などを使うといいでしょう。
これは以下のコマンドで行うことができます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cldivseq \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--query=保存領域の配列 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--border=start \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル1 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル2↓</span>
          </span>
</p>
<p class="ltx_p">このコマンドでは、指定された配列をNeedleman-Wunschアルゴリズムを用いたアライメントによって15%まで不一致を許して探します。
該当する部位が見つかったら、その左端を境界として配列を2つに分け、それぞれ出力ファイル1と出力ファイル2に保存します。
該当する部位が見つからなかった場合は、そのまま出力ファイル1だけに保存されます。
信頼度配列ファイルがある場合には、こちらも塩基配列に合わせて分割されます。
なお、指定する配列は対象配列と同一のストランドにしておいて下さい。
ストランドが異なる場合は、<span class="ltx_text ltx_font_typewriter">--reversecomplement</span>オプションを付加して実行することで、<span class="ltx_text ltx_font_typewriter">--query</span>に指定された配列の逆相補配列をアライメントに用いるようになります。</p>
</div>
<div id="Ch5.S6.p2" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">--border</span>オプションを<span class="ltx_text ltx_font_typewriter">start</span>ではなく<span class="ltx_text ltx_font_typewriter">end</span>にすることで、検索に一致した部位の右端を境界として分割することができます。
<span class="ltx_text ltx_font_typewriter">--border=both</span>にした場合は、検索に一致した部位はどちらのファイルにも出力されません(これがデフォルト設定です)。
検索した配列が見つからなかった場合は出力ファイル1のみに配列が保存され、出力ファイル2には配列が保存されませんが、これでは都合が悪い場合は<span class="ltx_text ltx_font_typewriter">--makedummy</span>オプションを付加することでダミーの塩基配列が出力ファイル2に保存されます。
分割した各領域の配列で別個にホスト生物を同定した上で同定結果を統合する場合など、配列間で対応がとれていないと困る場合にご利用下さい。
ここでは2分割の例を挙げましたが、分割後にさらに分割を繰り返すことで3分割や4分割も可能です。</p>
</div>
</section>
<section id="Ch5.S7" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.7 </span>ITSxやMetaxaによるITS・SSU rRNA配列の抽出</h3>

<div id="Ch5.S7.p1" class="ltx_para">
<p class="ltx_p">ITSxは核ITS1・ITS2領域を認識してその部位だけを取り出すことができるプログラムです<cite class="ltx_cite"><a href="#bib.bib3" title="" class="ltx_ref">(Bengtsson-Palme <span class="ltx_text ltx_font_italic">et al</span>., 2013)</a></cite>。
多くの分類群でITSは非常に変異に富んでいますが、ずっと保守的なSSU・LSU rRNAと隣接しているため、これらの配列が残っていると、その配列の影響でITSでは明確に区別できる遠縁な生物のSSU・LSU配列がBLAST検索時にヒットしてしまい、うまく同定できなくなってしまうことがあります。
ITSxでITS領域のみを切り出して同定することでこのような問題に対処できます。</p>
</div>
<div id="Ch5.S7.p2" class="ltx_para">
<p class="ltx_p">MetaxaはITSxと同様にSSU (12S/16S/18S) rRNAを区別してそれぞれの部位だけを取り出すことができるプログラムです<cite class="ltx_cite"><a href="#bib.bib4" title="" class="ltx_ref">(Bengtsson <span class="ltx_text ltx_font_italic">et al</span>., 2011)</a></cite>。
SSU rRNAは真核生物のメタバーコーディング・DNAバーコーディングに広く利用されている領域ですが、核だけでなくミトコンドリアや葉緑体、混入した細菌にも含まれているため、核のSSUを標的とするPCRを行った場合にも多少はミトコンドリアや細菌のSSU rRNAが混入してしまいます。
そのような配列は群集生態学的解析の障害となるため、このプログラムで前もって除去しておくと後の解析が楽になります。</p>
</div>
<div id="Ch5.S7.p3" class="ltx_para">
<p class="ltx_p">いずれのプログラムもインストール方法、使用方法をここでは説明しません。
それぞれのWebサイトとマニュアルをご覧下さい。
これらのプログラムで作成したFASTA配列ファイルを第<a href="#Ch5.S2" title="5.2 集計表からの特定のOTU・サンプルの除去 ‣ 第5章 OTUピッキング結果の要約と後処理 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>節の<span class="ltx_text ltx_font_typewriter">clfiltersum</span>の<span class="ltx_text ltx_font_typewriter">--otuseq</span>オプションに指定して集計表を加工することで、この配列ファイルに含まれているOTUだけの集計表を作成することができます。</p>
</div>
</section>
<section id="Ch5.S8" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5.8 </span>非ターゲット領域の探索と削除</h3>

<div id="Ch5.S8.p1" class="ltx_para">
<p class="ltx_p">ITSxやMetaxaはITSとSSU rRNA領域にしか使用できませんが、もっと汎用的な非ターゲット領域の探索方法があります。
一つはBLASTなどで検索して配列がどの遺伝子のものかを判定してくれるプログラムにかけることで、もう一つは多重整列プログラムを利用することです。
ClustalW2・ClustalX2 <cite class="ltx_cite"><a href="#bib.bib13" title="" class="ltx_ref">(Larkin <span class="ltx_text ltx_font_italic">et al</span>., 2007)</a></cite>やMAFFT <cite class="ltx_cite"><a href="#bib.bib10" title="" class="ltx_ref">(Katoh and Standley, 2013)</a></cite>には、多重整列した結果を系統的に近いものが近くになるように並び替えて出力することができます。
この機能を使って並び替えた上で、多重整列の閲覧ソフトで表示して目で確認すればどれが非ターゲット領域かすぐわかります。
非ターゲット領域のOTUを除去したFASTA配列ファイルを第<a href="#Ch5.S2" title="5.2 集計表からの特定のOTU・サンプルの除去 ‣ 第5章 OTUピッキング結果の要約と後処理 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>節の<span class="ltx_text ltx_font_typewriter">clfiltersum</span>の<span class="ltx_text ltx_font_typewriter">--otuseq</span>オプションに指定して集計表を加工することで、この配列ファイルに含まれているOTUだけの集計表を作成することができます。</p>
</div>
</section>
</section>
<section id="Ch6" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第6章 </span>DRAへのデータ登録</h2>

<div id="Ch6.p1" class="ltx_para">
<p class="ltx_p">クラスタリング後の配列は従来通りDDBJなどに登録すればいいですが、新型シーケンサーの生データはDDBJ Sequence Read Archive (DRA)というところへ登録することになっています(サンガー法シーケンサーの生データはTrace Archive)。
本書にあるように複数サンプルからのDNAにタグを付けてシーケンスした場合、サンプルごとのデータファイルに分割して登録することを求められます。
これは<span class="ltx_text ltx_font_typewriter">clsplitseq</span>によって分割したFASTQを使えば問題ありません。
同一鋳型由来配列ファイルが複数ある場合は、GZIP圧縮を解除してから連結して再圧縮するだけで構いません。</p>
</div>
<div id="Ch6.p2" class="ltx_para">
<p class="ltx_p">また、サンプルについての情報(メタデータ)を記述したXMLファイルを作成しなくてはなりません。
データ登録を受け付けている側でも、XML作成を補助するツールが用意されていますが大量サンプルを扱っている場合は用意するのは大変です。
そこで、DRA登録用XML作成を補助する<span class="ltx_text ltx_font_typewriter">clmaketsv</span>および<span class="ltx_text ltx_font_typewriter">clmakexml</span>というコマンドを用意しています。
以下でこれらの使用法を説明します。</p>
</div>
<div id="Ch6.p3" class="ltx_para">
<p class="ltx_p">DRAへの登録には、DDBJが管理するD-wayでのユーザーアカウント作成と公開鍵の登録が必要です。
詳しくはDRA Handbook
<br class="ltx_break"><a href="http://trace.ddbj.nig.ac.jp/dra/submission.shtml" title="" class="ltx_ref">http://trace.ddbj.nig.ac.jp/dra/submission.shtml</a>
<br class="ltx_break">をご覧下さい。
登録の際、Submission、Study、Experiment、Sample、Runの概念と対応関係を把握している必要がありますので、その部分を特に注意して読んで理解しておいて下さい。</p>
</div>
<div id="Ch6.p4" class="ltx_para">
<p class="ltx_p">DRAでは、StudyはBioProjectという研究プロジェクトデータベースに登録して、それを参照することになります。
BioProjectへの登録はBioProject Handbook
<br class="ltx_break"><a href="http://trace.ddbj.nig.ac.jp/bioproject/submission.html" title="" class="ltx_ref">http://trace.ddbj.nig.ac.jp/bioproject/submission.html</a>
<br class="ltx_break">を参照して予め済ませておいて下さい。</p>
</div>
<div id="Ch6.p5" class="ltx_para">
<p class="ltx_p">さらに、SampleはBioSampleという研究サンプルデータベースに登録して、それを参照します。
BioSampleへの登録はBioSample Handbook
<br class="ltx_break"><a href="http://trace.ddbj.nig.ac.jp/biosample/submission.html" title="" class="ltx_ref">http://trace.ddbj.nig.ac.jp/biosample/submission.html</a>
<br class="ltx_break">を参照して予め済ませておいて下さい。
なお、メタゲノムを鋳型としてユニバーサルプライマーで増幅を行ったシーケンスサンプルの場合、MIMarks-SurveyをMIxSのタイプとして指定します。
サンプルの採集された高度、水深、温度、湿度、pHなど、様々な情報を付加しておくことができます。
後世のためにも、面倒がらずにできるだけ多くの情報を付加しておいて下さい。
なお、各項目の意味は、Genomic Standards Consortiumから提供されているチェックリスト
<br class="ltx_break"><a href="http://wiki.gensc.org/index.php?title=MIMARKS" title="" class="ltx_ref">http://wiki.gensc.org/index.php?title=MIMARKS</a>
<br class="ltx_break">を確認して下さい。
これを見てもわからない場合はDDBJに問い合わせて下さい。
特に、地下や海底下のサンプルでは、平均海水面からサンプリング地点までの高さ・深さ、地面からサンプリング地点までの高さ・深さ、平均海水面から地面までの高さ・深さを入れる項目があってややこしいのでご注意下さい。</p>
</div>
<section id="Ch6.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6.1 </span>XML作成用タブ区切りテキストの作成</h3>

<div id="Ch6.S1.p1" class="ltx_para">
<p class="ltx_p">DRAに登録するXMLには、登録するFASTQファイルごとにそのファイルに含まれている配列の情報を記述します。
これは非常に複雑で大変なため、一旦単純なタブ区切りテキストに書き出した上で、Excelなどを用いてそれを編集し、編集後のタブ区切りテキストからXMLを作成します。
タブ区切りテキストを生成するコマンドは<span class="ltx_text ltx_font_typewriter">clmaketsv</span>です。
以下のように使って下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clmaketsv \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル1 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">中略 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイルN \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p">入力ファイルは登録するものを指定して下さい。
ワイルドカードも使えます。
タブ区切りテキストができたら、表計算ソフトなどに読み込ませて、各セルを埋めていって下さい。
なお、Excelでは特定の文字列を勝手に日時などと認識して変換してしまう機能(無効にする方法はありません)がありますので、十分注意して下さい。
各セル内では、<span class="ltx_text ltx_font_typewriter">[Hogehoge,Fugafuga]</span>とあった場合は<span class="ltx_text ltx_font_typewriter">Hogehoge</span>または<span class="ltx_text ltx_font_typewriter">Fugafuga</span>のどちらかを選んで括弧と選ばなかったものを消して下さい。
<span class="ltx_text ltx_font_typewriter">&lt;Fill in this cell&gt;</span>とあった場合は、<span class="ltx_text ltx_font_typewriter">&lt;&gt;</span>内の指示に従ってセルを埋めて下さい(括弧は残さない)。
その他のセルは適当に自分で考えて何とかして下さい。
なお、BioProject IDやBioSample IDは、正式なアクセッション番号がまだ発行されていない場合、DDBJに申請したときのSubmission ID (BioProjectではPSUBから始まり、BioSampleではSSUBから始まるもの)を入力しておけば問題ありません。</p>
</div>
</section>
<section id="Ch6.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6.2 </span>タブ区切りテキストからのDRA登録用XMLファイルの生成</h3>

<div id="Ch6.S2.p1" class="ltx_para">
<p class="ltx_p">タブ区切りテキストの編集が終わったら、タブ区切りテキストとして保存した上で以下のように<span class="ltx_text ltx_font_typewriter">clmakexml</span>を実行して下さい。
登録に必要なXMLファイル群が生成されます。
なお、タブ区切りテキストは一度に複数指定することも可能です。
ただし、各ファイルの最初の3行に記述する内容は、最初のファイルのものしか利用されません。
2ファイル目以降の最初の3行は無視されます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clmakexml \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">タブ区切りテキストファイル \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">DRAから割り振られたsubmission-ID↓</span>
          </span>
</p>
<p class="ltx_p">DRAでは、「Create new submission(s)」によってsubmission-IDが割り振られます。
<span class="ltx_text ltx_font_typewriter">ユーザーID-0001</span>などとなっているはずです。
<span class="ltx_text ltx_font_typewriter">DRAから割り振られたsubmission-ID</span>にはこれを指定します。
すると、<span class="ltx_text ltx_font_typewriter">submission-ID.*.xml</span>という名前のファイルが3つ生成されます。
これをDRAのXML Upload機能を利用して送信します。
その他もろもろの処理が終わると、登録してあるメールアドレスに割り振られたアクセッション番号が送られてきます。
ただし、論文にはBioProject IDを書くことが多いと思います。</p>
</div>
</section>
</section>
<section id="Ch7" class="ltx_chapter">
<h2 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">第7章 </span>DNAバーコーディングによる配列のホスト生物同定</h2>

<div id="Ch7.p1" class="ltx_para">
<p class="ltx_p">DNAバーコーディングは、近年非常に多くの分野で応用が進められている、生物の同定方法です。
しかし、既知配列データベースが不十分な上、それを前提とした同定アルゴリズムが欠けていました。
そこで、筆者は「問い合わせ配列と最近隣配列との間の変異量＜分類群内の最大変異量」という規準を考案し、これを実現するアルゴリズムQCauto法<cite class="ltx_cite"><a href="#bib.bib18" title="" class="ltx_ref">(Tanabe and Toju, 2013)</a></cite>をClaidentに実装しました。
ただし、その配列のホストの可能性がある全生物が記載済みで、しかもそのバーコード配列もデータベースに登録済みである場合には、そのような難しいことを考えずに最近隣配列と同種とみなせばよいでしょう。
そちらの方法もClaidentには実装してあります。
以下のコマンドは全てターミナルかコンソールで実行して下さい。
基本的なターミナルの使い方の知識は持っているものとして話を進めます。</p>
</div>
<section id="Ch7.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7.1 </span>BLAST検索による近隣既知配列群の取得</h3>

<div id="Ch7.S1.p1" class="ltx_para">
<p class="ltx_p">以下のコマンドで、「問い合わせ配列と最近隣配列との間の変異量＜分類群内の最大変異量」という条件を満たすために検討すべき近隣既知配列群(のGenBank ID)を取得できます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clidentseq \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--blastdb=overall_genus \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p">入力ファイルにはFASTA形式の塩基配列ファイルを指定します。
<span class="ltx_text ltx_font_typewriter">--blastdb</span>オプションでは、BLAST検索に用いるデータベース名を指定します。
筆者が用意しているデータベースは以下の通りです。</p>
<dl id="Ch7.I1" class="ltx_description">
<dt id="Ch7.I1.ix1"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">animals_COX1_genus</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix1.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">動物(Metazoa)のmtDNA </span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">COX1</span>
                <span class="ltx_text" style="font-size:90%;">配列で属以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix2"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">animals_COX1_species</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix2.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが種以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix3"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">animals_mt_genus</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix3.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">動物(Metazoa)のmtDNA配列で属以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix4"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">animals_mt_species</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix4.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが種以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix5"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">eukaryota_LSU_genus</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix5.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">真核生物のLSU (28S) rRNA配列で属以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix6"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">eukaryota_LSU_species</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix6.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが種以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix7"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">eukaryota_SSU_genus</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix7.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">真核生物のSSU (18S) rRNA配列で属以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix8"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">eukaryota_SSU_species</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix8.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが種以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix9"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">fungi_ITS_genus</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix9.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">真菌のITS配列で属以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix10"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">fungi_ITS_species</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix10.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが種以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix11"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">overall_class</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix11.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">NCBI ntの中で綱以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix12"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">overall_order</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix12.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが目以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix13"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">overall_family</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix13.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが科以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix14"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">overall_genus</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix14.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが属以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix15"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">overall_species</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix15.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが種以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix16"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">plants_matK_genus</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix16.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">緑色植物のcpDNA </span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">matK</span>
                <span class="ltx_text" style="font-size:90%;">配列で属以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix17"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">plants_matK_species</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix17.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが種以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix18"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">plants_rbcL_genus</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix18.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">緑色植物のcpDNA </span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">rbcL</span>
                <span class="ltx_text" style="font-size:90%;">配列で属以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix19"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">plants_rbcL_species</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix19.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが種以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix20"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">plants_trnH-psbA_genus</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix20.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">緑色植物のcpDNA </span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">trnH</span>
                <span class="ltx_text" style="font-size:90%;">–</span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">psbA</span>
                <span class="ltx_text" style="font-size:90%;">配列で属以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix21"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">plants_trnH-psbA_species</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix21.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが種以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix22"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">prokaryota_16S_genus</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix22.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">原核生物の16S rRNA配列で属以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix23"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">prokaryota_16S_species</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix23.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが種以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix24"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">prokaryota_all_genus</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix24.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">原核生物の配列で属以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix25"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">prokaryota_all_species</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix25.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text" style="font-size:90%;">同上だが種以下の情報があるもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix26"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">semiall_class</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix26.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">overall_class</span>
                <span class="ltx_text" style="font-size:90%;">から脊椎動物と</span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">Caenorhabditis</span>
                <span class="ltx_text" style="font-size:90%;">と</span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">Drosophila</span>
                <span class="ltx_text" style="font-size:90%;">を除いたもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix27"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">semiall_order</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix27.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">overall_order</span>
                <span class="ltx_text" style="font-size:90%;">から脊椎動物と</span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">Caenorhabditis</span>
                <span class="ltx_text" style="font-size:90%;">と</span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">Drosophila</span>
                <span class="ltx_text" style="font-size:90%;">を除いたもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix28"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">semiall_family</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix28.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">overall_family</span>
                <span class="ltx_text" style="font-size:90%;">から脊椎動物と</span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">Caenorhabditis</span>
                <span class="ltx_text" style="font-size:90%;">と</span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">Drosophila</span>
                <span class="ltx_text" style="font-size:90%;">を除いたもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix29"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">semiall_genus</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix29.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">overall_genus</span>
                <span class="ltx_text" style="font-size:90%;">から脊椎動物と</span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">Caenorhabditis</span>
                <span class="ltx_text" style="font-size:90%;">と</span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">Drosophila</span>
                <span class="ltx_text" style="font-size:90%;">を除いたもの</span>
              </p>
</div>
</dd>
<dt id="Ch7.I1.ix30"><span class="ltx_tag ltx_tag_description">
              <span class="ltx_text" style="font-size:90%;">semiall_species</span>
            </span></dt>
<dd>
<div id="Ch7.I1.ix30.p1" class="ltx_para">
<p class="ltx_p">
                <span class="ltx_text ltx_font_typewriter" style="font-size:90%;">overall_species</span>
                <span class="ltx_text" style="font-size:90%;">から脊椎動物と</span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">Caenorhabditis</span>
                <span class="ltx_text" style="font-size:90%;">と</span>
                <span class="ltx_text ltx_font_italic" style="font-size:90%;">Drosophila</span>
                <span class="ltx_text" style="font-size:90%;">を除いたもの</span>
              </p>
</div>
</dd>
</dl>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">overall_*</span>は非常に巨大なため、多くのメモリを必要としますが、これらは万能なのでどんな配列にも使えますし、想定外の分類群や想定外の遺伝子座の配列の混入があってもとんでもない誤同定を避けることができます。
<span class="ltx_text ltx_font_typewriter">overall_genus</span>では属以下の情報がある、つまりそれなりに分類群の情報が信頼できそうな配列を選別していますが、あまりにマイナーな分類群だとそれでは近隣配列が見つからないことがあります。
その場合は、綱以下まで同定された配列のデータベース<span class="ltx_text ltx_font_typewriter">overall_class</span>を使ってみて下さい。
その他のデータベースは、<span class="ltx_text ltx_font_typewriter">overall_*</span>よりもメモリ占有量がずっと少ないため、メモリの少ないコンピュータでも動作します。</p>
</div>
<section id="Ch7.S1.SS1" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1.1 </span>キャッシュデータベースの構築による高速化</h4>

<div id="Ch7.S1.SS1.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">clidentseq</span>はBLAST検索を何度も繰り返しますが、それなりの時間と大量のメモリを必要とします。そこで、予め問い合わせ配列と類似した配列の上位1万本(設定で変更可)のヒットした部位のみをBLASTデータベースから取得してキャッシュとなるBLASTデータベースを作成しておき、<span class="ltx_text ltx_font_typewriter">clidentseq</span>ではこれを対象として検索することで、劇的な高速化が可能です。これを行うのが<span class="ltx_text ltx_font_typewriter">clmakecachedb</span>で、以下のように用います。</p>
</div>
<div id="Ch7.S1.SS1.p2" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clmakecachedb \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--blastdb=overall_genus \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力フォルダ↓</span>
            </span>
</p>
</div>
<div id="Ch7.S1.SS1.p3" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">clidentseq</span>の実行時には、<span class="ltx_text ltx_font_typewriter">--blastdb</span>オプションに上記コマンドの出力フォルダを指定することで、キャッシュデータベースが使われます。
ただし、<span class="ltx_text ltx_font_typewriter">clmakecachedb</span>と<span class="ltx_text ltx_font_typewriter">clidentseq</span>の入力ファイルは同一である必要があります。
メモリの使用量も大幅に減少しますので、<span class="ltx_text ltx_font_typewriter">overall_*</span>を使用してもメモリ16GB程度で済みます。</p>
</div>
</section>
<section id="Ch7.S1.SS2" class="ltx_subsection">
<h4 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1.2 </span>参照配列データベースが全種を網羅している場合</h4>

<div id="Ch7.S1.SS2.p1" class="ltx_para">
<p class="ltx_p">問い合わせ配列のホストの可能性がある全生物が記載済みで、しかもそのバーコード配列も全て参照配列データベースに登録済みである場合には、以下のようにして類似度99%以上の上位1位(1位タイを含む)を近隣配列とすればいいでしょう。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clidentseq \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">blastn -task megablast -word_size 16 end \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--method=1,99% \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--blastdb=overall_genus \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--numthreads=使用するCPU数 \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
            </span>
<span class="ltx_p ltx_align_left">
              <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
            </span>
</p>
</div>
<div id="Ch7.S1.SS2.p2" class="ltx_para">
<p class="ltx_p">類似度99%以上の上位1位の配列を探し出す場合、BLAST検索オプションは<span class="ltx_text ltx_font_typewriter">-task megablast -word_size 16</span>としても見逃すことはまずないでしょうから、ここでは高速化のためにこのように指定しています。</p>
</div>
</section>
</section>
<section id="Ch7.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7.2 </span>近隣既知配列群に基づく同定</h3>

<div id="Ch7.S2.p1" class="ltx_para">
<p class="ltx_p">以下のコマンドで、近隣既知配列群の所属分類群が同一になるまで分類階層を上げていくことで配列を同定します。
これはlowest common ancestor (LCA) algorithmと呼ばれています<cite class="ltx_cite"><a href="#bib.bib8" title="" class="ltx_ref">(Huson <span class="ltx_text ltx_font_italic">et al</span>., 2007)</a></cite>。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; classigntax \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--taxdb=overall_genus \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p">入力ファイルには前節で作成した<span class="ltx_text ltx_font_typewriter">clidentseq</span>の出力ファイルを指定して下さい。
<span class="ltx_text ltx_font_typewriter">--taxdb</span>は既知配列の所属分類群データベース指定オプションです。
BLASTデータベースと同じ名前のものがインストールされていますので、それを指定して下さい。</p>
</div>
<div id="Ch7.S2.p2" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">classigntax</span>のデフォルト設定では、少なくとも2本以上の近隣既知配列がないと同定することができません。
第<a href="#Ch7.S1.SS2" title="7.1.2 参照配列データベースが全種を網羅している場合 ‣ 7.1 BLAST検索による近隣既知配列群の取得 ‣ 第7章 DNAバーコーディングによる配列のホスト生物同定 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.1.2</span></a>節のように<span class="ltx_text ltx_font_typewriter">clidentseq</span>の実行時に<span class="ltx_text ltx_font_typewriter">--method=1,99%</span>を指定していると、近隣既知配列が1本しかないために一つも同定できないことになります。
この場合は以下のようにして必要な近隣既知配列数を1にします。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; classigntax \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--taxdb=overall_genus \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minnsupporter=1 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p">出力ファイルは表<a href="#Ch7.T1" title="表 7.1 ‣ 7.2 近隣既知配列群に基づく同定 ‣ 第7章 DNAバーコーディングによる配列のホスト生物同定 ‣ 生態学のためのメタバーコーディングとDNAバーコーディング" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7.1</span></a>のような形のタブ区切りのテキストになっています。</p>
</div>
<figure id="Ch7.T1" class="ltx_table">
<table class="ltx_tabular ltx_centering ltx_align_middle">
<thead class="ltx_thead">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">query</span>
              </th>
<th class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">phylum</span>
              </th>
<th class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">genus</span>
              </th>
<th class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">species</span>
              </th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">
                <span class="ltx_text" style="font-size:80%;">seqA</span>
              </th>
<td class="ltx_td ltx_align_left ltx_border_tt">
                <span class="ltx_text" style="font-size:80%;">Ascomycota</span>
              </td>
<td class="ltx_td ltx_align_left ltx_border_tt">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Chloridium</span>
              </td>
<td class="ltx_td ltx_align_left ltx_border_tt">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Chloridium virescens</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqB</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Ascomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Chloridium</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Chloridium virescens</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqC</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Ascomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Chloridium</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Chloridium virescens</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqD</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Basidiomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Amanita</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Amanita fuliginea</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqE</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Basidiomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Coltriciella</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Coltriciella dependens</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqF</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Basidiomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Filobasidium</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Filobasidium uniguttulatum</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqG</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Basidiomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Laccaria</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Laccaria bicolor</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqH</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Basidiomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Lactarius</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Lactarius quietus</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqI</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Basidiomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Russula</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Russula densifolia</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqJ</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Basidiomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Russula</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Russula densifolia</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqK</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Basidiomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Russula</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Russula densifolia</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqL</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Basidiomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Russula</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Russula vesca</span>
              </td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqM</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Basidiomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Agaricus</span>
              </td>
<td class="ltx_td"></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqN</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Basidiomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Amanita</span>
              </td>
<td class="ltx_td"></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqO</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Basidiomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Amanita</span>
              </td>
<td class="ltx_td"></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqP</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Ascomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Bisporella</span>
              </td>
<td class="ltx_td"></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqQ</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Ascomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Capronia</span>
              </td>
<td class="ltx_td"></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqR</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Ascomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Capronia</span>
              </td>
<td class="ltx_td"></td>
</tr>
<tr class="ltx_tr">
<th class="ltx_td ltx_align_left ltx_border_r">
                <span class="ltx_text" style="font-size:80%;">seqS</span>
              </th>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text" style="font-size:80%;">Ascomycota</span>
              </td>
<td class="ltx_td ltx_align_left">
                <span class="ltx_text ltx_font_italic" style="font-size:80%;">Cenococcum</span>
              </td>
<td class="ltx_td"></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">表 7.1: </span>同定結果の例 — 空欄はunidentified、つまり不明ということです。
横幅を抑えるためいくつかの分類階層は省いてあります。</figcaption>
</figure>
<div id="Ch7.S2.p3" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">classigntax</span>のデフォルト設定では、全ての近隣既知配列の所属分類群が同一になるまで分類階層を上げていきますので、誤同定された配列が混ざっていたりした場合には下位の分類階層はほとんど不明になってしまいます。
これは「ほぼ正しいと思われる」結果を得る＝「間違えない」ことをデフォルト設定では優先しているためですが、近隣既知配列が多い場合、多少不一致を許容して誤同定の可能性を増やしてでもできるだけ下位の分類階層まで同定したい場合があります。
そのような場合には以下のように<span class="ltx_text ltx_font_typewriter">--maxpopposer</span>と<span class="ltx_text ltx_font_typewriter">--minsoratio</span>を指定します。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; classigntax \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--taxdb=overall_genus \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--maxpopposer=0.05 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--minsoratio=19 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">入力ファイル \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">classigntax</span>は結果として採用する分類群に該当する配列をsupporter配列とし、該当しない配列をopposer配列とします。
<span class="ltx_text ltx_font_typewriter">--maxpopposer</span>にはopposer配列の存在を許容する割合を百分率で指定します。
<span class="ltx_text ltx_font_typewriter">--minsoratio</span>はsupporter配列数とopposer配列数の比の下限値を指定します。
supporter配列数とopposer配列数がこれを下回るような同定結果は許容せず分類階層を上げていきます。
2つのオプションが必要なのは、その分類階層の情報がない配列が存在し得るためです。
そのような配列はsupporterでもopposerでもないので、2つのオプションが必要になります。
上記の例では、近隣既知配列中、5%までのopposer配列を許容し、opposer配列の19倍以上のsupporter配列を必要とします。</p>
</div>
</section>
<section id="Ch7.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7.3 </span>複数の同定結果の統合</h3>

<div id="Ch7.S3.p1" class="ltx_para">
<p class="ltx_p">例えば植物の<span class="ltx_text ltx_font_italic">rbcL</span>と<span class="ltx_text ltx_font_italic">matK</span>など、複数のバーコード領域を併用しなければ同定できないこともありますし、<span class="ltx_text ltx_font_typewriter">overall_genus</span>と<span class="ltx_text ltx_font_typewriter">overall_class</span>での同定結果のいいとこ取りをしたい場合があります。
また、厳密なLCAによる同定結果と5%までopposerを許容するLCAの同定結果の組み合わせでいいとこ取りしたい場合もあるでしょう。
そのようなことが、複数の同定結果を統合することで可能になります。</p>
</div>
<div id="Ch7.S3.p2" class="ltx_para">
<p class="ltx_p">植物の<span class="ltx_text ltx_font_italic">rbcL</span>と<span class="ltx_text ltx_font_italic">matK</span>を併用して同定する場合は、より深くまで同定できている方の結果を採用するのがいいでしょう。
これは以下のコマンドでできます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clmergeassign \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--priority=equal \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--preferlower \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">rbcLでの同定結果 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">matKでの同定結果 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p">より保守的に考えるなら、以下のようにして、両方の同定結果が同一か、一方では未同定の場合だけ採用することもできます。
ただし、上の階層で不一致だった場合には、同定結果が一方で未同定でも採用されません。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clmergeassign \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--priority=equal \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">rbcLでの同定結果 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">matKでの同定結果 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_italic">trnH</span>–<span class="ltx_text ltx_font_italic">psbA</span>も併用して、最も深くまで同定できているものを採用する場合は以下のようにします。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clmergeassign \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--priority=equal \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--preferlower \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">rbcLでの同定結果 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">matKでの同定結果 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">trnH-psbAでの同定結果 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">overall_genus</span>の結果を優先的に採用し、<span class="ltx_text ltx_font_typewriter">overall_genus</span>で同定できている分類階層までは一致しているが<span class="ltx_text ltx_font_typewriter">overall_class</span>の方がより下位まで同定できている場合だけ採用するには、以下のようにします。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clmergeassign \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--priority=descend \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">overall_genusでの同定結果 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">overall_classでの同定結果 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
<p class="ltx_p">同様に、厳密なLCAによる結果を優先し、厳密なLCAで同定できている分類階層まで一致しているが制約を緩めたLCAによる結果の方がより下位まで同定できている場合にのみ採用するには、以下のようにします。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; clmergeassign \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">--priority=descend \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">厳密なLCAでの同定結果 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">制約を緩めたLCAでの同定結果 \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">出力ファイル↓</span>
          </span>
</p>
</div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">引用文献</h2>

<ul class="ltx_biblist" style="padding:0em 0em 0em 1em;text-indent:-1em;">
      
<li id="bib.bib2" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Andrews, S., 2010, “Software distributed by the author at
http://www.bioinformatics.babraham.ac.uk/projects/fastqc/.”.

</span>
      </li>
      
<li id="bib.bib3" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Bengtsson-Palme, J., Ryberg, M., Hartmann, M., Branco, S., Wang, Z., Godhe, A.,
De Wit, P., Sánchez-García, M., Ebersberger, I., de Sousa, F., Amend,
A., Jumpponen, A., Unterseher, M., Kristiansson, E., Abarenkov, K., Bertrand,
Y. J. K., Sanli, K., Eriksson, K. M., Vik, U., Veldre, V., and Nilsson,
R. H., 2013, “Improved software detection and extraction of ITS1 and ITS2
from ribosomal ITS sequences of fungi and other eukaryotes for analysis of
environmental sequencing data”, <span class="ltx_text ltx_font_italic">Methods in Ecology and Evolution</span>,
<span class="ltx_text ltx_font_bold">4</span>, No. 10, 914–919.

</span>
      </li>
      
<li id="bib.bib4" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Bengtsson, J., Eriksson, K. M., Hartmann, M., Wang, Z., Shenoy, B. D., Grelet,
G.-A., Abarenkov, K., Petri, A., Rosenblad, M. A., and Nilsson, R. H., 2011,
“Metaxa: a software tool for automated detection and discrimination among
ribosomal small subunit (12S/16S/18S) sequences of archaea, bacteria,
eukaryotes, mitochondria, and chloroplasts in metagenomes and environmental
sequencing datasets.”, <span class="ltx_text ltx_font_italic">Antonie Van Leeuwenhoek</span>, <span class="ltx_text ltx_font_bold">100</span>, No. 3,
471–475, Oct.

</span>
      </li>
      
<li id="bib.bib5" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Edgar, R. C., Haas, B. J., Clemente, J. C., Quince, C., and Knight, R., 2011,
“UCHIME improves sensitivity and speed of chimera detection.”, <span class="ltx_text ltx_font_italic">Bioinformatics</span>, <span class="ltx_text ltx_font_bold">27</span>, No. 16, 2194–2200, Aug.

</span>
      </li>
      
<li id="bib.bib6" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Fadrosh, D. W., Ma, B., Gajer, P., Sengamalay, N., Ott, S., Brotman, R. M., and
Ravel, J., 2014, “An improved dual-indexing approach for multiplexed 16S
rRNA gene sequencing on the Illumina MiSeq platform.”, <span class="ltx_text ltx_font_italic">Microbiome</span>,
<span class="ltx_text ltx_font_bold">2</span>, No. 1,  6.

</span>
      </li>
      
<li id="bib.bib7" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Hamady, M., Walker, J. J., Harris, J. K., Gold, N. J., and Knight, R., 2008,
“Error-correcting barcoded primers for pyrosequencing hundreds of samples in
multiplex.”, <span class="ltx_text ltx_font_italic">Nature Methods</span>, <span class="ltx_text ltx_font_bold">5</span>, No. 3, 235–237, Mar.

</span>
      </li>
      
<li id="bib.bib8" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Huson, D. H., Auch, A. F., Qi, J., and Schuster, S. C., 2007, “MEGAN analysis
of metagenomic data.”, <span class="ltx_text ltx_font_italic">Genome Research</span>, <span class="ltx_text ltx_font_bold">17</span>, No. 3, 377–386,
Mar.

</span>
      </li>
      
<li id="bib.bib9" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Illumina corporation, 2013, “16S metagenomic sequencing library
preparation.”.

</span>
      </li>
      
<li id="bib.bib10" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Katoh, K. and Standley, D. M., 2013, “MAFFT multiple sequence alignment
software version 7: improvements in performance and usability.”, <span class="ltx_text ltx_font_italic">Molecular Biology and Evolution</span>, <span class="ltx_text ltx_font_bold">30</span>, No. 4, 772–780, Apr.

</span>
      </li>
      
<li id="bib.bib11" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Kunin, V., Engelbrektson, A., Ochman, H., and Hugenholtz, P., 2010, “Wrinkles
in the rare biosphere: pyrosequencing errors can lead to artificial inflation
of diversity estimates.”, <span class="ltx_text ltx_font_italic">Environmental Microbiology</span>, <span class="ltx_text ltx_font_bold">12</span>, No.
1, 118–123, Jan.

</span>
      </li>
      
<li id="bib.bib12" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Lange, A., Jost, S., Heider, D., Bock, C., Budeus, B., Schilling, E.,
Strittmatter, A., Boenigk, J., and Hoffmann, D., 2015, “AmpliconDuo: A
Split-Sample Filtering Protocol for High-Throughput Amplicon Sequencing of
Microbial Communities.”, <span class="ltx_text ltx_font_italic">PLoS One</span>, <span class="ltx_text ltx_font_bold">10</span>, No. 11, e0141590.

</span>
      </li>
      
<li id="bib.bib13" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Larkin, M. A., Blackshields, G., Brown, N. P., Chenna, R., McGettigan, P. A.,
McWilliam, H., Valentin, F., Wallace, I. M., Wilm, A., Lopez, R., Thompson,
J. D., Gibson, T. J., and Higgins, D. G., 2007, “Clustal W and Clustal X
version 2.0.”, <span class="ltx_text ltx_font_italic">Bioinformatics</span>, <span class="ltx_text ltx_font_bold">23</span>, No. 21, 2947–2948, Nov.

</span>
      </li>
      
<li id="bib.bib14" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Li, W., Fu, L., Niu, B., Wu, S., and Wooley, J., 2012, “Ultrafast clustering
algorithms for metagenomic sequence analysis.”, <span class="ltx_text ltx_font_italic">Briefings in
Bioinformatics</span>, <span class="ltx_text ltx_font_bold">13</span>, No. 6, 656–668, Nov.

</span>
      </li>
      
<li id="bib.bib15" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Nelson, M. C., Morrison, H. G., Benjamino, J., Grim, S. L., and Graf, J., 2014,
“Analysis, optimization and verification of Illumina-generated 16S rRNA gene
amplicon surveys.”, <span class="ltx_text ltx_font_italic">PLoS One</span>, <span class="ltx_text ltx_font_bold">9</span>, No. 4, e94249.

</span>
      </li>
      
<li id="bib.bib16" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Schmieder, R. and Edwards, R., 2011, “Quality control and preprocessing of
metagenomic datasets.”, <span class="ltx_text ltx_font_italic">Bioinformatics</span>, <span class="ltx_text ltx_font_bold">27</span>, No. 6, 863–864,
Mar.

</span>
      </li>
      
<li id="bib.bib17" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Stevens, J. L., Jackson, R. L., and Olson, J. B., 2013, “Slowing PCR ramp
speed reduces chimera formation from environmental samples.”, <span class="ltx_text ltx_font_italic">Journal
of Microbiological Methods</span>, <span class="ltx_text ltx_font_bold">93</span>, No. 3, 203–205, Jun.

</span>
      </li>
      
<li id="bib.bib18" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Tanabe, A. S. and Toju, H., 2013, “Two new computational methods for universal
DNA barcoding: a benchmark using barcode sequences of bacteria, archaea,
animals, fungi, and land plants.”, <span class="ltx_text ltx_font_italic">PLoS One</span>, <span class="ltx_text ltx_font_bold">8</span>, No. 10,
e76910.

</span>
      </li>
      
<li id="bib.bib19" class="ltx_bibitem" style="padding:0em 0em 0.2em 0em;">
        
        
        
        
        
<span class="ltx_bibblock">
Zhang, J., Kobert, K., Flouri, T., and Stamatakis, A., 2014, “PEAR: a fast and
accurate Illumina Paired-End reAd mergeR.”, <span class="ltx_text ltx_font_italic">Bioinformatics</span>,
<span class="ltx_text ltx_font_bold">30</span>, No. 5, 614–620, Mar.

</span>
      </li>
    
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">付録 A </span>その他のプログラム・データベースのインストール</h2>

<section id="A1.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">A.1 </span>bcl2fastqのインストール</h3>

<div id="A1.S1.p1" class="ltx_para">
<p class="ltx_p">Illuminaから提供されている、BCL形式のベースコールデータからFASTQを生成するプログラムbcl2fastqはMiSeq・HiSeq用のv1.8.4およびNextSeq 500・HiSeq X用のv2.17.1.14が
<br class="ltx_break"><a href="http://support.illumina.com/downloads/bcl2fastq_conversion_software.html" title="" class="ltx_ref">http://support.illumina.com/downloads/bcl2fastq_conversion_software.html</a>
<br class="ltx_break">からダウンロードできます。
v1.8.4は以下のようにインストールできます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># alienのインストール</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">$ sudo apt-get install alien</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># bcl2fastq v1.8.4のダウンロード</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">$ wget \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">ftp://webdata:webdata@ussd-ftp.illumina.com/Downloads/Software/bcl2fastq/bcl2fastq-1.8.4-Linux-x86_64.rpm</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># .rpmから.debへの変換とインストール</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">$ sudo alien -i \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">bcl2fastq-1.8.4-Linux-x86_64.rpm</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># bcl2fastqに必要な追加パッケージのインストール</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">$ sudo apt-get install libxml-simple-perl xsltproc</span>
          </span>
</p>
</div>
<div id="A1.S1.p2" class="ltx_para">
<p class="ltx_p">Ubuntu・Xubuntu・Lubuntuの14.04LTSでは、Perlのバージョンが新しすぎ、より古いバージョンを前提として書かれたbcl2fastqが動作しません。
そこで以下のようにして問題の部分を書き換えます。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">$ sudo perl -i -npe \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">'s/qw\(ELAND_FASTQ_FILES_PER_PROCESS\)/\("ELAND_FASTQ_FILES_PER_PROCESS"\)/' \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">/usr/local/lib/bcl2fastq-1.8.4/perl/Casava/Alignment/Config.pm</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">$ sudo perl -i -npe \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">'s/qw\(ELAND_GENOME\)/\("ELAND_GENOME"\)/' \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">/usr/local/lib/bcl2fastq-1.8.4/perl/Casava/Alignment/Config.pm</span>
          </span>
</p>
<p class="ltx_p">テキストエディタで
<br class="ltx_break"><span class="ltx_text ltx_font_typewriter">/usr/local/lib/bcl2fastq-1.8.4/perl/Casava/Alignment/Config.pm
<br class="ltx_break"></span>の747行目と751行目を手動で書き換えても構いません。
<span class="ltx_text ltx_font_typewriter">qw(HOGEHOGE)</span>を<span class="ltx_text ltx_font_typewriter">("HOGEHOGE")</span>に書き換えて下さい。</p>
</div>
<div id="A1.S1.p3" class="ltx_para">
<p class="ltx_p">v2.17.1.14のインストールをする場合は以下のようにコマンドを実行して下さい。</p>
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># rpm2cpioとcpioのインストール</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sudo apt-get install rpm2cpio cpio↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># bcl2fastq2 v2.17のダウンロード</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; wget \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">ftp://webdata2:webdata2@ussd-ftp.illumina.com/downloads/software/bcl2fastq/bcl2fastq2-v2.17.1.14-Linux-x86_64.zip↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 圧縮ファイルの展開</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; unzip -qq bcl2fastq2-v2.17.1.14-Linux-x86_64.zip↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># .rpmを展開してコマンドを抽出</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; rpm2cpio \</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">bcl2fastq2-v2.17.1.14-Linux-x86_64.rpm | cpio -id↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># コマンドをインストール</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; sudo mv usr/local/bin/bcl2fastq /usr/local/bin/↓</span>
          </span>
</p>
</div>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">付録 B </span>ターミナルコマンド集</h2>

<section id="A2.S1" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">B.1 </span>配列を数え上げる</h3>

<div id="A2.S1.p1" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># FASTQの場合</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; grep -P -c '^\+$' inputfile↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># GZIP圧縮FASTQの場合</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; gzip -dc inputfile | grep -P -c '^\+$'↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># BZIP2圧縮FASTQの場合</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; bzip2 -dc inputfile | grep -P -c '^\+$'↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># XZ圧縮FASTQの場合</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; xz -dc inputfile | grep -P -c '^\+$'↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># FASTAの場合</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; grep -P -c '^&gt;' inputfile↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># GZIP圧縮FASTAの場合</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; gzip -dc inputfile | grep -P -c '^&gt;'↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># BZIP2圧縮FASTAの場合</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; bzip2 -dc inputfile | grep -P -c '^&gt;'↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># XZ圧縮FASTAの場合</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; xz -dc inputfile | grep -P -c '^&gt;'↓</span>
          </span>
</p>
</div>
</section>
<section id="A2.S2" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">B.2 </span>配列を閲覧する</h3>

<div id="A2.S2.p1" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 無圧縮ファイル内容を画面に出力</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; cat inputfile↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 無圧縮ファイル内容をスクロールしながら見る</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; less inputfile↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># GZIP圧縮ファイル内容を画面に出力</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; gzip -dc inputfile↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># GZIP圧縮ファイル内容をスクロールしながら見る</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; gzip -dc inputfile | less↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># FASTQの最初の1配列を画面に出力</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; head -n 4 inputfile↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># GZIP圧縮FASTQの最初の1配列を画面に出力</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; gzip -dc inputfile | head -n 4↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># FASTQの特定の配列を検索して画面に出力</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; grep -P -A 3 '^\@配列名の正規表現' inputfile↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># GZIP圧縮FASTQの特定の配列を検索して画面に出力</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; gzip -dc inputfile | grep -P -A 3 '^\@配列名の正規表現'↓</span>
          </span>
</p>
</div>
</section>
<section id="A2.S3" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">B.3 </span>圧縮・展開</h3>

<div id="A2.S3.p1" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># フォルダ内の全.fastq.gzを展開</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; for f in *.fastq.gz↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">do gzip -d $f↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">done↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># フォルダ内の全.fastq.gzを展開(サブフォルダ含む)</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; for f in `find . -name *.fastq.gz`↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">do gzip -d $f↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">done↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 4つのCPUを使用してフォルダ内の全.fastq.gzを展開</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; ls *.fastq.gz | xargs -L 1 -P 4 gzip -d↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 4つのCPUを使用してフォルダ内の全.fastq.gzを展開(サブフォルダ含む)</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; find . -name *.fastq.gz | xargs -L 1 -P 4 gzip -d↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># フォルダ内の全.fastqを圧縮</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; for f in *.fastq↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">do gzip $f↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">done↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># フォルダ内の全.fastqを圧縮(サブフォルダ含む)</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; for f in `find . -name *.fastq`↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">do gzip $f↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">done↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 4つのCPUを使用してフォルダ内の全.fastqを圧縮</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; ls *.fastq | xargs -L 1 -P 4 gzip↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># 4つのCPUを使用してフォルダ内の全.fastqを圧縮(サブフォルダ含む)</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; find . -name *.fastq | xargs -L 1 -P 4 gzip↓</span>
          </span>
</p>
</div>
</section>
<section id="A2.S4" class="ltx_section">
<h3 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">B.4 </span>抽出・保存</h3>

<div id="A2.S4.p1" class="ltx_para">
<p class="ltx_p ltx_align_left" style="border:1px solid #000000;padding:0.5em 0em 0.5em 0em;">
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># FASTQから最初の1万配列を抽出</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; head -n 40000 inputfile &gt; outputfile↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># FASTQから最後の1万配列を抽出</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; tail -n 40000 inputfile &gt; outputfile↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># GZIP圧縮FASTQから最初の1万配列を抽出してGZIP圧縮FASTQへ保存</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; gzip -dc inputfile | head -n 40000 | gzip -c &gt; outputfile↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># GZIP圧縮FASTQから最後の1万配列を抽出してGZIP圧縮FASTQへ保存</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; gzip -dc inputfile | tail -n 40000 | gzip -c &gt; outputfile↓</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;"># GZIP圧縮FASTQの特定の配列を検索してGZIP圧縮FASTQへ保存</span>
          </span>
<span class="ltx_p ltx_align_left">
            <span class="ltx_text ltx_font_typewriter" style="font-size:80%;">&gt; gzip -dc inputfile | grep -P -A 3 '^\@配列名の正規表現' | gzip -c &gt; outputfile↓</span>
          </span>
</p>
</div>
</section>
</section><div class="ltx_rdf" about="" property="dcterms:subject" content="メタゲノム"></div>

</article>
</div>
</div>
</body>
</html>
